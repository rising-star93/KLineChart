(this["webpackJsonpreact-sample"]=this["webpackJsonpreact-sample"]||[]).push([[0],[,,,,,,,function(t,e,i){"use strict";t.exports=i(18)},,,function(t){t.exports=JSON.parse('{"all_solid":"\u5168\u5b9e\u5fc3","all_stroke":"\u5168\u7a7a\u5fc3","up_stroke":"\u6da8\u7a7a\u5fc3","down_stroke":"\u8dcc\u7a7a\u5fc3","ohlc":"\u7f8e\u56fd\u7ebf","timezone":"\u65f6\u533a","technical_indicator_params":"\u6307\u6807\u53c2\u6570","utc":"\u4e16\u754c\u7edf\u4e00\u65f6\u95f4","honolulu":"\u6a80\u9999\u5c71","juneau":"\u6731\u8bfa","los_angeles":"\u6d1b\u6749\u77f6","chicago":"\u829d\u52a0\u54e5","toronto":"\u591a\u4f26\u591a","sao_paulo":"\u5723\u4fdd\u7f57","london":"\u4f26\u6566","berlin":"\u67cf\u6797","bahrain":"\u5df4\u6797","dubai":"\u8fea\u62dc","ashkhabad":"\u963f\u4ec0\u54c8\u5df4\u5fb7","almaty":"\u963f\u62c9\u6728\u56fe","bangkok":"\u66fc\u8c37","shanghai":"\u4e0a\u6d77","tokyo":"\u4e1c\u4eac","sydney":"\u6089\u5c3c","norfolk":"\u8bfa\u798f\u514b\u5c9b","cancel":"\u53d6\u6d88","confirm":"\u786e\u5b9a"}')},function(t){t.exports=JSON.parse('{"all_solid":"All Solid","all_stroke":"All Stroke","up_stroke":"Up Stroke","down_stroke":"Down Stroke","ohlc":"OHLC","timezone":"Timezone","technical_indicator_params":"Indicator Parameter","utc":"UTC","honolulu":"Honolulu","juneau":"Juneau","los_angeles":"Los Angeles","chicago":"Chicago","toronto":"Toronto","sao_paulo":"Sao Paulo","london":"London","berlin":"Berlin","bahrain":"Bahrain","dubai":"Dubai","ashkhabad":"Ashkhabad","almaty":"Almaty","bangkok":"Bangkok","shanghai":"Shanghai","tokyo":"Tokyo","sydney":"Sydney","norfolk":"Norfolk","cancel":"Cancel","confirm":"OK"}')},function(t,e,i){t.exports=i(24)},,,,,,function(t,e,i){!function(t){"use strict";function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){for(var i=0;e.length>i;i++){var a=e[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}function n(t,e,i){return e&&a(t.prototype,e),i&&a(t,i),t}function r(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&function(t,e){(Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}(t,e)}function o(t){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function c(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function h(t,e,i){return(h="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,i){var a=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=o(t)););return t}(t,e);if(a){var n=Object.getOwnPropertyDescriptor(a,e);return n.get?n.get.call(i):n.value}})(t,e,i||t)}function l(t,e){if(v(t)&&v(e))for(var i in e)if(t.hasOwnProperty(i)){var a=t[i],n=e[i];v(n)&&v(a)&&!d(n)&&!d(a)?l(a,n):(e[i]||0===e[i]||!1===e[i])&&(t[i]=e[i])}}function u(t){if(!t||!v(t))return t;var e,i,a;for(i in e=d(t)?[]:{},t)t.hasOwnProperty(i)&&(e[i]=(a=t[i])&&v(a)?u(a):a);return e}function d(t){return"[object Array]"===Object.prototype.toString.call(t)}function _(t){return"function"==typeof t}function v(t){var i=e(t);return"function"===i||!!t&&"object"===i}function f(t){return"number"==typeof t&&!isNaN(t)}var p,y,m="dash",x="left",g="right",k="inside",w="outside",S="real_time",M="candle_stick",D="solid",T="always",C="standard",b={grid:{display:!0,horizontal:{display:!0,size:1,color:"#393939",style:m,dashValue:[2,2]},vertical:{display:!1,size:1,color:"#393939",style:m,dashValue:[2,2]}},candleStick:{bar:{style:D,upColor:"#26A69A",downColor:"#EF5350",noChangeColor:"#666666"},priceMark:{display:!0,high:{display:!0,color:"#D9D9D9",textMargin:5,textSize:10,textFamily:"Arial"},low:{display:!0,color:"#D9D9D9",textMargin:5,textSize:10,textFamily:"Arial"},last:{display:!0,upColor:"#26A69A",downColor:"#EF5350",noChangeColor:"#666666",line:{display:!0,style:m,dashValue:[4,4],size:1},text:{display:!0,size:12,paddingLeft:2,paddingTop:2,paddingRight:2,paddingBottom:2,color:"#FFFFFF",family:"Arial"}}}},realTime:{timeLine:{color:"#1e88e5",size:1,areaFillColor:"rgba(30, 136, 229, 0.08)"},averageLine:{display:!0,color:"#F5A623",size:1}},technicalIndicator:{bar:{upColor:"#26A69A",downColor:"#EF5350",noChangeColor:"#999999"},line:{size:1,colors:["#D9D9D9","#F5A623","#F601FF","#1587DD","#1e88e5"]},lastValueMark:{display:!1,textColor:"#ffffff",textSize:12,textFamily:"Arial",textPaddingLeft:3,textPaddingTop:2,textPaddingRight:3,textPaddingBottom:2}},xAxis:{display:!0,maxHeight:50,minHeight:30,axisLine:{display:!0,color:"#888888",size:1},tickText:{display:!0,color:"#D9D9D9",size:12,family:"Arial",margin:3},tickLine:{display:!0,size:1,length:3,color:"#888888"}},yAxis:{display:!0,maxWidth:100,minWidth:60,type:"normal",position:g,axisLine:{display:!0,color:"#888888",size:1},tickText:{position:w,display:!0,color:"#D9D9D9",size:12,family:"Arial",margin:3},tickLine:{display:!0,size:1,length:3,color:"#888888"}},separator:{size:1,color:"#888888",fill:!0},floatLayer:{crossHair:{display:!0,horizontal:{display:!0,line:{display:!0,style:m,dashValue:[4,2],size:1,color:"#888888"},text:{display:!0,color:"#D9D9D9",size:12,family:"Arial",paddingLeft:2,paddingRight:2,paddingTop:2,paddingBottom:2,borderSize:1,borderColor:"#505050",backgroundColor:"#505050"}},vertical:{display:!0,line:{display:!0,style:m,dashValue:[4,2],size:1,color:"#888888"},text:{display:!0,color:"#D9D9D9",size:12,family:"Arial",paddingLeft:2,paddingRight:2,paddingTop:2,paddingBottom:2,borderSize:1,borderColor:"#505050",backgroundColor:"#505050"}}},prompt:{displayRule:T,candleStick:{showType:C,labels:["\u65f6\u95f4","\u5f00","\u6536","\u9ad8","\u4f4e","\u6210\u4ea4\u91cf"],values:null,rect:{paddingLeft:0,paddingRight:0,paddingTop:0,paddingBottom:6,left:8,top:8,right:8,borderRadius:4,borderSize:1,borderColor:"#3f4254",fillColor:"rgba(17, 17, 17, .3)"},text:{size:12,family:"Arial",color:"#D9D9D9",marginLeft:8,marginTop:6,marginRight:8,marginBottom:0}},technicalIndicator:{text:{size:12,family:"Arial",color:"#D9D9D9",marginTop:6,marginRight:8,marginBottom:0,marginLeft:8},point:{display:!0,radius:3}}}},graphicMark:{line:{color:"#1e88e5",size:1},point:{backgroundColor:"#1e88e5",borderColor:"#1e88e5",borderSize:1,radius:4,activeBackgroundColor:"#1e88e5",activeBorderColor:"#1e88e5",activeBorderSize:1,activeRadius:6},text:{color:"#1e88e5",size:12,family:"Arial",marginLeft:2,marginRight:2,marginTop:2,marginBottom:6}}},P={NO:"NO",AVERAGE:"AVERAGE",MA:"MA",EMA:"EMA",VOL:"VOL",MACD:"MACD",BOLL:"BOLL",KDJ:"KDJ",RSI:"RSI",BIAS:"BIAS",BRAR:"BRAR",CCI:"CCI",DMI:"DMI",CR:"CR",PSY:"PSY",DMA:"DMA",TRIX:"TRIX",OBV:"OBV",VR:"VR",WR:"WR",MTM:"MTM",EMV:"EMV",SAR:"SAR"},E=(r(p={},P.MA,[5,10,30,60]),r(p,P.EMA,[6,12,20]),r(p,P.VOL,[5,10,20]),r(p,P.MACD,[12,26,9]),r(p,P.BOLL,[20]),r(p,P.KDJ,[9,3,3]),r(p,P.RSI,[6,12,24]),r(p,P.BIAS,[6,12,24]),r(p,P.BRAR,[26]),r(p,P.CCI,[13]),r(p,P.DMI,[14,6]),r(p,P.CR,[26,10,20,40,60]),r(p,P.PSY,[12]),r(p,P.DMA,[10,50,10]),r(p,P.TRIX,[12,20]),r(p,P.OBV,[30]),r(p,P.VR,[24,30]),r(p,P.WR,[13,34,89]),r(p,P.MTM,[6,10]),r(p,P.EMV,[14,9]),r(p,P.SAR,[2,2,20]),p);function A(t,e,i){var a=i[e]||[],n=(t||{})[e.toLowerCase()]||{},r=[],s=[];switch(e){case P.MA:a.forEach((function(t){var e="ma".concat(t);r.push(e),s.push(n[e])}));break;case P.EMA:a.forEach((function(t){var e="ema".concat(t);r.push(e),s.push(n[e])}));break;case P.MACD:r=["diff","dea","macd"],s=[n.diff,n.dea,n.macd];break;case P.VOL:a.forEach((function(t){var e="ma".concat(t);r.push(e),s.push(n[e])})),r.push("num"),s.push(n.num);break;case P.BOLL:r=["up","mid","dn"],s=[n.up,n.mid,n.dn];break;case P.BIAS:a.forEach((function(t){var e="bias".concat(t);r.push(e),s.push(n[e])}));break;case P.BRAR:r=["br","ar"],s=[n.br,n.ar];break;case P.CCI:r=["cci"],s=[n.cci];break;case P.CR:r=["cr","ma1","ma2","ma3","ma4"],s=[n.cr,n.ma1,n.ma2,n.ma3,n.ma4];break;case P.DMA:r=["dif","difMa"],s=[n.dif,n.difMa];break;case P.DMI:r=["mdi","pdi","adx","adxr"],s=[n.mdi,n.pdi,n.adx,n.adxr];break;case P.KDJ:r=["k","d","j"],s=[n.k,n.d,n.j];break;case P.RSI:a.forEach((function(t){var e="rsi".concat(t);r.push(e),s.push(n[e])}));break;case P.PSY:r=["psy"],s=[n.psy];break;case P.TRIX:r=["trix","maTrix"],s=[n.trix,n.maTrix];break;case P.OBV:r=["obv","maObv"],s=[n.obv,n.maObv];break;case P.VR:r=["vr","maVr"],s=[n.vr,n.maVr];break;case P.WR:r=["wr1","wr2","wr3"],s=[n.wr1,n.wr2,n.wr3];break;case P.MTM:r=["mtm","mtmMa"],s=[n.mtm,n.mtmMa];break;case P.EMV:r=["emv","maEmv"],s=[n.emv,n.maEmv];break;case P.SAR:r=["sar"],s=[n.sar]}return{keys:r,values:s}}var L=(r(y={price:2,volume:0},P.NO,2),r(y,P.MA,2),r(y,P.EMA,2),r(y,P.VOL,0),r(y,P.MACD,2),r(y,P.BOLL,2),r(y,P.KDJ,2),r(y,P.RSI,2),r(y,P.BIAS,2),r(y,P.BRAR,4),r(y,P.CCI,4),r(y,P.DMI,4),r(y,P.CR,2),r(y,P.PSY,2),r(y,P.DMA,4),r(y,P.TRIX,4),r(y,P.OBV,4),r(y,P.VR,4),r(y,P.WR,4),r(y,P.MTM,4),r(y,P.EMV,4),r(y,P.SAR,2),y),I={};function O(t,e){for(var i=t.length,a=0;i>a;a++)e(a);return t}function z(t,e){for(var i=0,a=0;t.length>a;a++){var n=t[a].close-e;i+=n*n}var r=i>0,s=Math.sqrt((i=Math.abs(i))/t.length);return r?s:-1*s}function R(t){var e=0;if(t&&t.length>0){var i=t.length;e=t[0].high;for(var a=1;i>a;a++)e=Math.max(t[a].high,e)}return e}function H(t){var e=0;if(t&&t.length>0){var i=t.length;e=t[0].low;for(var a=1;i>a;a++)e=Math.min(t[a].low,e)}return e}function B(t){var e=0,i=0;if(t&&t.length>0){var a=t.length;e=t[0].high,i=t[0].low;for(var n=1;a>n;n++)e=Math.max(t[n].high,e),i=Math.min(t[n].low,i)}return[e,i]}function V(t){return t&&d(t)}function Y(t,e){return V(t)&&t.length===e}function F(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"--";if(t&&v(t)){var a=t[e];if(a||0===a||!1===a)return a}return i}I[P.AVERAGE]=function(t){var e=0,i=0;return O(t,(function(a){e+=t[a].turnover||0,t[a].average=0!==(i+=t[a].volume||0)?e/i:0}))},I[P.MA]=function(t,e){if(!V(e))return t;var i=[],a=e.length;return O(t,(function(n){for(var r={},s=t[n].close,o=0;a>o;o++){i[o]=(i[o]||0)+s;var c=e[o];c>n?r["ma".concat(c)]=i[o]/(n+1):(i[o]-=t[n-c].close,r["ma".concat(c)]=i[o]/c)}t[n].ma=r}))},I[P.EMA]=function(t,e){if(!V(e))return t;var i=[],a=e.length;return O(t,(function(n){for(var r={},s=t[n].close,o=0;a>o;o++){var c;c=0===n?s:(2*s+(e[o]-1)*i[o])/(e[o]+1),r["ema".concat(e[o])]=c,i[o]=c}t[n].ema=r}))},I[P.VOL]=function(t,e){if(!V(e))return t;var i=[],a=e.length;return O(t,(function(n){for(var r=t[n].volume,s={},o=0;a>o;o++){i[o]=(i[o]||0)+r;var c=e[o];c>n?s["ma".concat(c)]=i[o]/(n+1):(i[o]-=t[n-c].volume,s["ma".concat(c)]=i[o]/c)}s.num=r,t[n].vol=s}))},I[P.MACD]=function(t,e){if(!Y(e,3))return t;var i,a,n=0,r=0,s=0,o=0,c=0;return O(t,(function(h){var l=t[h].close;0===h?(i=l,a=l):(i=(2*l+(e[0]-1)*n)/(e[0]+1),a=(2*l+(e[1]-1)*r)/(e[1]+1)),n=i,r=a,c=o=(2*(s=i-a)+c*(e[2]-1))/(e[2]+1),t[h].macd={diff:s,dea:o,macd:2*(s-o)}}))},I[P.BOLL]=function(t,e){if(!Y(e,1))return t;var i,a,n=0;return O(t,(function(r){n+=t[r].close,e[0]>r?(i=n/(r+1),a=z(t.slice(0,r+1),i)):(i=(n-=t[r-e[0]].close)/e[0],a=z(t.slice(r-(e[0]-1),r+1),i)),t[r].boll={up:i+2*a,mid:i,dn:i-2*a}}))},I[P.KDJ]=function(t,e){return Y(e,3)?O(t,(function(s){var o=t[s].close;e[0]-1>s?(n=H(t.slice(0,s+1)),r=R(t.slice(0,s+1))):(n=H(t.slice(s-(e[0]-1),s+1)),r=R(t.slice(s-(e[0]-1),s+1))),t[s].kdj={k:i=(e[1]-1)/e[1]*(e[0]-1>s?50:t[s-1].kdj.k)+1/e[1]*((o-n)/(r-n==0?1:r-n)*100),d:a=(e[2]-1)/e[2]*(e[0]-1>s?50:t[s-1].kdj.d)+1/e[2]*i,j:3*i-2*a}})):t;var i,a,n,r},I[P.RSI]=function(t,e){if(!Y(e,3))return t;var i,a,n,s,o,c,h=0,l=0,u=0,d=0,_=0,v=0;return O(t,(function(f){var p,y=(r(p={},"rsi".concat(e[0]),0),r(p,"rsi".concat(e[1]),0),r(p,"rsi".concat(e[2]),0),p);if(f>0){var m=t[f].close-t[f-1].close;if(m>0)h+=m,u+=m,_+=m;else{var x=Math.abs(m);l+=x,d+=x,v+=x}if(e[0]>f)i=h/(f+1),a=(h+l)/(f+1);else{if(f>e[0]){var g=t[f-e[0]].close-t[f-e[0]-1].close;g>0?h-=g:l-=Math.abs(g)}i=h/e[0],a=(h+l)/e[0]}if(y["rsi".concat(e[0])]=0!==a?i/a*100:0,e[1]>f)n=u/(f+1),s=(u+d)/(f+1);else{if(f>e[1]){var k=t[f-e[1]].close-t[f-e[1]-1].close;k>0?u-=k:d-=Math.abs(k)}n=u/e[1],s=(u+d)/e[1]}if(y["rsi".concat(e[1])]=0!==s?n/s*100:0,e[2]>f)o=_/(f+1),c=(_+v)/(f+1);else{if(f>e[2]){var w=t[f-e[2]].close-t[f-e[2]-1].close;w>0?_-=w:v-=Math.abs(w)}o=_/e[2],c=(_+v)/e[2]}y["rsi".concat(e[2])]=0!==c?o/c*100:0}t[f].rsi=y}))},I[P.BIAS]=function(t,e){if(!Y(e,3))return t;var i,a,n,r=0,s=0,o=0;return O(t,(function(c){var h={},l=t[c].close;r+=l,s+=l,o+=l,i=e[0]>c?r/(c+1):(r-=t[c-e[0]].close)/e[0],h["bias".concat(e[0])]=(l-i)/i*100,a=e[1]>c?s/(c+1):(s-=t[c-e[1]].close)/e[1],h["bias".concat(e[1])]=(l-a)/a*100,n=e[2]>c?o/(c+1):(o-=t[c-e[2]].close)/e[2],h["bias".concat(e[2])]=(l-n)/n*100,t[c].bias=h}))},I[P.BRAR]=function(t,e){if(!Y(e,1))return t;var i=0,a=0,n=0,r=0,s=0,o=0;return O(t,(function(c){var h=t[c].high,l=t[c].low,u=t[c].open;if(s+=h-u,o+=u-l,c>0){var d=t[c-1].close;if(n+=h-d,r+=d-l,c>e[0]-1){var _=t[c-e[0]].high,v=t[c-e[0]].low,f=t[c-e[0]].open;if(c>e[0]){var p=t[c-e[0]-1].close;n-=_-p,r-=p-v}s-=_-f,o-=f-v}a=0!==o?s/o*100:0,i=0!==r?n/r*100:0}t[c].brar={br:i,ar:a}}))},I[P.CCI]=function(t,e){if(!Y(e,1))return t;var i,a,n=0,r=[],s=0;return O(t,(function(o){var c=t[o].close;n+=c;var h=(t[o].high+t[o].low+c)/3;if(e[0]>o)s+=Math.abs((i=n/(o+1))-c),r.push(i),a=s/(o+1);else{var l=t[o-e[0]].close;r.push(i=(n-=l)/e[0]),s+=Math.abs(i-c),a=(s-=Math.abs(r[o-e[0]]-l))/e[0]}t[o].cci={cci:0!==a?(h-i)/a/.015:0}}))},I[P.DMI]=function(t,e){if(!Y(e,2))return t;var i=0,a=0,n=0,r=0,s=[0],o=0,c=[0],h=0,l=[0],u=0,d=[0],_=0;return O(t,(function(v){if(v>0){var f=t[v-1].close,p=t[v].high,y=t[v].low,m=p-y,x=Math.abs(p-f),g=Math.abs(y-f),k=p-t[v-1].high,w=t[v-1].low-y,S=Math.max(Math.max(m,x),g);o+=S,s.push(S);var M=k>0&&k>w?k:0;h+=M,c.push(M);var D=w>0&&w>k?w:0;u+=D,l.push(D),v>e[0]-1&&(o-=s[v-e[0]],h-=c[v-e[0]],u-=l[v-e[0]]),0===o?(i=0,a=0):(i=100*h/o,a=100*u/o);var T=Math.abs(a-i)/(a+i)*100;if(_+=T,d.push(T),e[1]>v)r=n=_/(v+1);else{var C=d[v-e[1]];r=((n=(_-=C)/e[1])+C)/2}}t[v].dmi={pdi:i,mdi:a,adx:n,adxr:r}}))},I[P.CR]=function(t,e){if(!Y(e,5))return t;var i,a,n,r,s=0,o=0,c=0,h=0,l=[],u=0,d=[],_=0,v=[],f=0,p=[];return O(t,(function(y){if(y>0){var m=(t[y-1].high+t[y-1].close+t[y-1].low+t[y-1].open)/4,x=t[y].high-m;0>x&&(x=0),o+=x;var g=m-t[y].low;if(0>g&&(g=0),c+=g,y>e[0]){var k=(t[y-e[0]-1].high+t[y-e[0]-1].low+t[y-e[0]-1].close+t[y-e[0]-1].open)/4,w=t[y-e[0]].high-k;0>w&&(w=0);var S=k-t[y-e[0]].low;0>S&&(S=0),o-=w,c-=S}0!==c&&(s=o/c*100);var M=(t[y-1].high+t[y-1].low+t[y-1].close)/3,D=t[y].high-M;o+=D>0?D:0;var T=M-t[y].low;c+=T>0?T:0}h+=s,u+=s,_+=s,f+=s,i=e[1]>y?h/(y+1):(h-=t[y-e[1]].cr.cr)/e[1],l.push(i),a=e[2]>y?u/(y+1):(u-=t[y-e[2]].cr.cr)/e[2],d.push(a),n=e[3]>y?_/(y+1):(_-=t[y-e[3]].cr.cr)/e[3],v.push(n),r=e[4]>y?f/(y+1):(f-=t[y-e[4]].cr.cr)/e[4],p.push(r),t[y].cr={cr:s,ma1:5>y?l[0]:l[y-5],ma2:9>y?d[0]:d[y-9],ma3:17>y?v[0]:v[y-17],ma4:25>y?p[0]:p[y-25]}}))},I[P.PSY]=function(t,e){if(!Y(e,1))return t;var i=0,a=0;return O(t,(function(n){n>0&&(a+=t[n].close-t[n-1].close>0?1:0,e[0]>n?i=a/(n+1)*100:(n>e[0]&&(a-=t[n-e[0]+1].close-t[n-e[0]].close>0?1:0),i=a/e[0]*100)),t[n].psy={psy:i}}))},I[P.DMA]=function(t,e){if(!Y(e,3))return t;var i,a,n,r,s=0,o=0,c=0;return O(t,(function(h){var l=t[h].close;s+=l,o+=l,n=e[0]>h?s/(h+1):(s-=t[h-e[0]].close)/e[0],r=e[1]>h?o/(h+1):(o-=t[h-e[1]].close)/e[1],c+=i=n-r,a=e[2]>h?c/(h+1):(c-=t[h-e[2]].dma.dif)/e[2],t[h].dma={dif:i,difMa:a}}))},I[P.TRIX]=function(t,e){if(!Y(e,2))return t;var i,a,n,r,s=0,o=0,c=0,h=0,l=0,u=[];return O(t,(function(d){var _=t[d].close;if(0===d)r=n=a=_;else{r=(2*(n=(2*(a=(2*_+(e[0]-1)*c)/(e[0]+1))+(e[0]-1)*h)/(e[0]+1))+(e[0]-1)*l)/(e[0]+1);var v=u[d-1];s=0===v?0:(r-v)/v*100}c=a,h=n,l=r,u.push(r),o+=s,i=e[1]>d?o/(d+1):(o-=t[d-e[1]].trix.trix)/e[1],t[d].trix={trix:s,maTrix:i}}))},I[P.OBV]=function(t,e){if(!Y(e,1))return t;var i,a,n=0,r=0;return O(t,(function(s){var o=t[s].volume;if(0===s)i=o,r+=o;else{var c=t[s-1].close,h=t[s].close;r+=h>c?o:-o,i=h===c?0:r}n+=i,a=e[0]>s?n/(s+1):(n-=t[s-e[0]].obv.obv)/e[0],t[s].obv={obv:i,maObv:a}}))},I[P.VR]=function(t,e){if(!Y(e,2))return t;var i,a=0,n=0,r=0,s=0,o=0;return O(t,(function(c){var h=t[c].close,l=t[c].open,u=t[c].volume;if(h>l?a+=u:l>h?n+=u:r+=u,c>e[0]-1){var d=t[c-e[0]].close,_=t[c-e[0]].open,v=t[c-e[0]].volume;d>_?a-=v:_>d?n-=v:r-=v}var f=n+.5*r;0!==f&&(s=(a+.5*r)/f*100),o+=s,i=e[1]>c?o/(c+1):(o-=t[c-e[1]].vr.vr)/e[1],t[c].vr={vr:s,maVr:i}}))},I[P.WR]=function(t,e){if(!Y(e,3))return t;var i,a,n,r,s,o=Number.MIN_SAFE_INTEGER,c=Number.MAX_SAFE_INTEGER,h=Number.MIN_SAFE_INTEGER,l=Number.MAX_SAFE_INTEGER,u=Number.MIN_SAFE_INTEGER,d=Number.MAX_SAFE_INTEGER;return O(t,(function(_){var v=t[_].close,f=t[_].high,p=t[_].low;if(e[0]>_)o=Math.max(f,o),c=Math.min(p,c);else{var y=B(t.slice(_-e[0],_));o=y[0],c=y[1]}if(i=0!==(n=o-c)?(o-v)/n*100:0,e[1]>_)h=Math.max(f,h),l=Math.min(p,l);else{var m=B(t.slice(_-e[1],_));h=m[0],l=m[1]}if(a=0!==(r=h-l)?(h-v)/r*100:0,e[2]>_)u=Math.max(f,u),d=Math.min(p,d);else{var x=B(t.slice(_-e[2],_));u=x[0],d=x[1]}t[_].wr={wr1:i,wr2:a,wr3:0!==(s=u-d)?(u-v)/s*100:0}}))},I[P.MTM]=function(t,e){if(!Y(e,2))return t;var i,a,n=0;return O(t,(function(r){e[0]>r?(i=0,a=0):(n+=i=t[r].close-t[r-e[0]].close,e[0]+e[1]>r?a=n/(r-e[0]+1):(a=n/e[1],n-=t[r-e[1]].mtm.mtm)),t[r].mtm={mtm:i,mtmMa:a}}))},I[P.EMV]=function(t,e){if(!Y(e,2))return t;var i,a=0,n=0,r=0,s=[];return O(t,(function(o){if(o>0){var c=t[o].high,h=t[o].low;r=((c+h)/2-(t[o-1].high+t[o-1].low)/2)*(c-h)/t[o].turnover}s.push(r),e[0]>o?a+=r:a-=s[o-e[0]],n+=a,i=e[1]>o?n/(o+1):(n-=t[o-e[1]].emv.emv)/e[1],t[o].emv={emv:a,maEmv:i}}))},I[P.SAR]=function(t,e){if(!Y(e,3))return t;var i=e[0]/100,a=e[1]/100,n=e[2]/100,r=i,s=-100,o=!1,c=0;return O(t,(function(e){var h=c,l=t[e].high,u=t[e].low;if(o){(-100===s||l>s)&&(s=l,r=Math.min(r+a,n)),c=h+r*(s-h);var d=Math.min(t[Math.max(1,e)-1].low,u);c>t[e].low?(c=s,r=i,s=-100,o=!o):c>d&&(c=d)}else{(-100===s||s>u)&&(s=u,r=Math.min(r+a,n)),c=h+r*(s-h);var _=Math.max(t[Math.max(1,e)-1].high,l);t[e].high>c?(c=s,r=0,s=-100,o=!o):_>c&&(c=_)}t[e].sar={sar:c}}))};var G="en-us";function N(t,e,i){if(t&&f(t)){var a,n=new Date(t);try{a=new Intl.DateTimeFormat(G,{hour12:!1,timeZone:i,year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric"}).format(n)}catch(t){a=new Intl.DateTimeFormat(G,{hour12:!1,year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric"}).format(n)}var r=a.match(/^[\d]{1,2}\/[\d]{1,2}\/[\d]{4}/)[0].split("/"),s="".concat(1===r[0].length?"0".concat(r[0]):r[0]),o="".concat(1===r[1].length?"0".concat(r[1]):r[1]),c=a.match(/[\d]{2}:[\d]{2}$/)[0];switch("24"===c.match(/^[\d]{2}/)[0]&&(c=c.replace(/^[\d]{2}/,"00")),e){case"YYYY":return r[2];case"YYYY-MM":return"".concat(r[2],"-").concat(s);case"YYYY-MM-DD":return"".concat(r[2],"-").concat(s,"-").concat(o);case"YYYY-MM-DD hh:mm":return"".concat(r[2],"-").concat(s,"-").concat(o," ").concat(c);case"MM-DD":return"".concat(s,"-").concat(o);case"hh:mm":return c;default:return"".concat(s,"-").concat(o," ").concat(c)}}return"--"}function W(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,i=+t;return(i||0===i)&&f(i)?t.toFixed(e):"".concat(i)}var X="none",j="horizontalStraightLine",U="verticalStraightLine",K="straightLine",J="horizontalRayLine",Z="verticalRayLine",q="rayLine",$="horizontalSegmentLine",Q="verticalSegmentLine",tt="segmentLine",et="priceLine",it="priceChannelLine",at="parallelStraightLine",nt="fibonacciLine",rt=function(){function t(e,a){i(this,t),this._invalidateHandler=a,this._styleOptions=u(b),l(this._styleOptions,e),this._technicalIndicatorParamOptions=u(E),this._precisionOptions=u(L),this._timezone=null,this._dataList=[],this._loading=!0,this._loadMoreCallback=null,this._more=!0,this._totalDataSpace=0,this._dataSpace=6,this._barSpace=this._calcBarSpace(),this._offsetRightBarCount=50/this._dataSpace,this._leftMinVisibleBarCount=2,this._rightMinVisibleBarCount=2,this._from=0,this._to=0,this._crossHairPoint=null,this._crossHairSeriesTag=null,this._preOffsetRightBarCount=0,this._graphicMarkType=X,this._graphicMarkPoint=null,this._dragGraphicMarkFlag=!1,this._graphicMarkDatas={horizontalStraightLine:[],verticalStraightLine:[],straightLine:[],horizontalRayLine:[],verticalRayLine:[],rayLine:[],horizontalSegmentLine:[],verticalSegmentLine:[],segmentLine:[],priceLine:[],parallelStraightLine:[],priceChannelLine:[],fibonacciLine:[]}}return n(t,[{key:"_loadMoreHandler",value:function(){this._more&&!this._loading&&this._loadMoreCallback&&_(this._loadMoreCallback)&&(this._loading=!0,this._loadMoreCallback(F(this._dataList[0],"timestamp")))}},{key:"_calcBarSpace",value:function(){return Math.max(1,Math.min(Math.floor(.8*this._dataSpace),Math.floor(this._dataSpace)-1))}},{key:"_innerSetDataSpace",value:function(t){return!(!t||3>t||t>30||this._dataSpace===t)&&(this._dataSpace=t,this._barSpace=this._calcBarSpace(),!0)}},{key:"styleOptions",value:function(){return this._styleOptions}},{key:"applyStyleOptions",value:function(t){l(this._styleOptions,t)}},{key:"technicalIndicatorParamOptions",value:function(){return this._technicalIndicatorParamOptions}},{key:"applyTechnicalIndicatorParams",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];this._technicalIndicatorParamOptions.hasOwnProperty(t)&&(this._technicalIndicatorParamOptions[t]=e)}},{key:"precisionOptions",value:function(){return this._precisionOptions}},{key:"setTimezone",value:function(t){this._timezone=t}},{key:"timezone",value:function(){return this._timezone}},{key:"applyPrecision",value:function(t,e){!t&&0!==t||0>t||(this._precisionOptions.price=t,this._precisionOptions[P.MA]=t,this._precisionOptions[P.BOLL]=t,this._precisionOptions[P.SAR]=t),!e&&0!==e||0>e||(this._precisionOptions.volume=e,this._precisionOptions[P.VOL]=e)}},{key:"calcTechnicalIndicator",value:function(t){if(t===P.NO)return!0;var e=I[t];return!!e&&(this._dataList=e(this._dataList,this._technicalIndicatorParamOptions[t]),!0)}},{key:"dataList",value:function(){return this._dataList}},{key:"clearDataList",value:function(){this._more=!0,this._loading=!0,this._dataList=[],this._from=0,this._to=0}},{key:"addData",value:function(t,e,i){if(v(t)){if(d(t))return this._loading=!1,this._more="boolean"!=typeof i||i,this._dataList=t.concat(this._dataList),this.adjustOffsetBarCount(),4;if(this._dataList.length>e)return this._dataList[e]=t,3;var a=this._totalDataSpace/this._dataSpace>this._to-this._from?4:3;return this._dataList.push(t),0>this._offsetRightBarCount&&(this._offsetRightBarCount-=1),this.adjustOffsetBarCount(),a}return 0}},{key:"dataSpace",value:function(){return this._dataSpace}},{key:"barSpace",value:function(){return this._barSpace}},{key:"offsetRightBarCount",value:function(){return this._offsetRightBarCount}},{key:"setDataSpace",value:function(t){this._innerSetDataSpace(t)&&(this.adjustOffsetBarCount(),this._invalidateHandler())}},{key:"setTotalDataSpace",value:function(t){this._totalDataSpace!==t&&(this._totalDataSpace=t,this.adjustOffsetBarCount())}},{key:"setOffsetRightSpace",value:function(t){this._offsetRightBarCount=t/this._dataSpace,this.adjustOffsetBarCount()}},{key:"setLeftMinVisibleBarCount",value:function(t){f(t)&&t>0&&(this._leftMinVisibleBarCount=Math.ceil(t))}},{key:"setRightMinVisibleBarCount",value:function(t){f(t)&&t>0&&(this._rightMinVisibleBarCount=Math.ceil(t))}},{key:"from",value:function(){return this._from}},{key:"to",value:function(){return this._to}},{key:"crossHairPoint",value:function(){return this._crossHairPoint}},{key:"crossHairSeriesTag",value:function(){return this._crossHairSeriesTag}},{key:"setCrossHairSeriesTag",value:function(t){this._crossHairSeriesTag=t,this._invalidateHandler(2)}},{key:"setCrossHairPoint",value:function(t){this._crossHairPoint=t}},{key:"startScroll",value:function(){this._preOffsetRightBarCount=this._offsetRightBarCount}},{key:"scroll",value:function(t){var e=t/this._dataSpace;this._offsetRightBarCount=this._preOffsetRightBarCount-e,this.adjustOffsetBarCount(),e>0&&0===this._from&&this._loadMoreHandler(),this._invalidateHandler()}},{key:"coordinateToFloatIndex",value:function(t){return Math.round(1e6*(this._dataList.length+this._offsetRightBarCount-(this._totalDataSpace-t)/this._dataSpace))/1e6}},{key:"zoom",value:function(t,e){var i=this.coordinateToFloatIndex(e.x);this._innerSetDataSpace(this._dataSpace+t*(this._dataSpace/10))&&(this._offsetRightBarCount+=i-this.coordinateToFloatIndex(e.x),this.adjustOffsetBarCount(),this._invalidateHandler())}},{key:"adjustOffsetBarCount",value:function(){var t=this._dataList.length,e=this._totalDataSpace/this._dataSpace,i=1-this._barSpace/2/this._dataSpace,a=e-Math.min(this._leftMinVisibleBarCount,t)+i;this._offsetRightBarCount>a&&(this._offsetRightBarCount=a);var n=1-t+Math.min(this._rightMinVisibleBarCount,t)-i;n>this._offsetRightBarCount&&(this._offsetRightBarCount=n),this._to=Math.round(this._offsetRightBarCount+t),this._from=Math.floor(this._to-e)-1,this._to>t&&(this._to=t),0>this._from&&(this._from=0)}},{key:"graphicMarkType",value:function(){return this._graphicMarkType}},{key:"setGraphicMarkType",value:function(t){this._graphicMarkType=t}},{key:"dragGraphicMarkFlag",value:function(){return this._dragGraphicMarkFlag}},{key:"setDragGraphicMarkFlag",value:function(t){this._dragGraphicMarkFlag=t}},{key:"graphicMarkPoint",value:function(){return this._graphicMarkPoint}},{key:"setGraphicMarkPoint",value:function(t){this._graphicMarkPoint=t}},{key:"graphicMarkData",value:function(){return u(this._graphicMarkDatas)}},{key:"setGraphicMarkData",value:function(t){var e=this.shouldInvalidateGraphicMark();this._graphicMarkDatas=u(t),(e||this.shouldInvalidateGraphicMark())&&this._invalidateHandler(1)}},{key:"loadMore",value:function(t){this._loadMoreCallback=t}},{key:"shouldInvalidateGraphicMark",value:function(){if(this._graphicMarkType!==X)return!0;for(var t in this._graphicMarkDatas)if(this._graphicMarkDatas[t].length>0)return!0;return!1}}]),t}();function st(t){return(window.devicePixelRatio||1)/(t.backingStorePixelRatio||t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1)}function ot(t,e){return t.measureText(e).width}function ct(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Arial";return"".concat(t,"px ").concat(e)}function ht(t,e,i,a){t.beginPath();var n=t.lineWidth%2?.5:0;t.moveTo(i,e+n),t.lineTo(a,e+n),t.stroke(),t.closePath()}function lt(t,e,i,a){t.beginPath();var n=t.lineWidth%2?.5:0;t.moveTo(e+n,i),t.lineTo(e+n,a),t.stroke(),t.closePath()}function ut(t,e){t.save(),t.lineWidth%2&&t.translate(.5,.5),e(),t.restore()}var dt=function(){function t(e){i(this,t),this._container=e.container,this._chartData=e.chartData,this._width=-1,this._height=-1,this._initBefore(e),this._initElement(),this._mainWidget=this._createMainWidget(this._mainWidgetCell,e),this._yAxisWidget=this._createYAxisWidget(this._yAxisWidgetCell,e)}return n(t,[{key:"_initBefore",value:function(t){}},{key:"_initElement",value:function(){this._element=document.createElement("div"),this._element.style.margin="0",this._element.style.padding="0",this._element.style.position="relative",this._element.style.overflow="hidden",this._element.style.width="100%",this._mainWidgetCell=this._createCell(),this._yAxisWidgetCell=this._createCell(),this._element.appendChild(this._mainWidgetCell),this._element.appendChild(this._yAxisWidgetCell);var t=this._container.lastChild;t?this._container.insertBefore(this._element,t):this._container.appendChild(this._element)}},{key:"_createCell",value:function(){var t=document.createElement("div");return t.style.display="table-cell",t.style.position="absolute",t.style.margin="0",t.style.padding="0",t.style.top="0",t.style.zIndex="1",t}},{key:"_createMainWidget",value:function(t,e){}},{key:"_createYAxisWidget",value:function(t,e){}},{key:"_setCellSize",value:function(t,e){t.style.left="".concat(e.left,"px"),t.style.width="".concat(e.width,"px"),t.style.height="".concat(e.height,"px")}},{key:"_computeAxis",value:function(){}},{key:"width",value:function(){return this._element.offsetWidth}},{key:"height",value:function(){return this._height}},{key:"setTempHeight",value:function(t){this._height=t}},{key:"setSize",value:function(t,e){this._height=t.height,this._element.style.height="".concat(t.height,"px"),this._setCellSize(this._mainWidgetCell,t),this._setCellSize(this._yAxisWidgetCell,e),this._mainWidget.setSize(t.width,this._height),this._yAxisWidget&&this._yAxisWidget.setSize(e.width,e.height)}},{key:"invalidate",value:function(t){4===t&&this._computeAxis(),this._yAxisWidget&&this._yAxisWidget.invalidate(t),this._mainWidget.invalidate(t)}},{key:"getImage",value:function(t,e){var i=document.createElement("canvas"),a=i.getContext("2d"),n=st(a),r=this._element.offsetWidth,s=this._element.offsetHeight;i.style.width="".concat(r,"px"),i.style.height="".concat(s,"px"),i.width=r*n,i.height=s*n,a.scale(n,n);var o=this._mainWidgetCell.offsetWidth,c=this._mainWidgetCell.offsetHeight,h=parseInt(this._mainWidgetCell.style.left,10),l=this._yAxisWidgetCell.offsetWidth,u=this._yAxisWidgetCell.offsetHeight,d=parseInt(this._yAxisWidgetCell.style.left,10);return a.drawImage(this._mainWidget.getImage(t,e),h,0,o,c),this._yAxisWidget&&a.drawImage(this._yAxisWidget.getImage(t),d,0,l,u),i}},{key:"destroy",value:function(){this._container.removeChild(this._element)}}]),t}(),_t=function(){function t(e){i(this,t),this._width=0,this._height=0,this._initElement(e.container),this._mainView=this._createMainView(this._element,e),this._expandView=this._createExpandView(this._element,e),this._floatLayerView=this._createFloatLayerView(this._element,e)}return n(t,[{key:"_initElement",value:function(t){this._element=document.createElement("div"),this._element.style.margin="0",this._element.style.padding="0",this._element.style.width="100%",this._element.style.height="100%",this._element.style.position="relative",this._element.style.overflow="hidden",t.appendChild(this._element)}},{key:"_createMainView",value:function(t,e){}},{key:"_createExpandView",value:function(t,e){}},{key:"_createFloatLayerView",value:function(t,e){}},{key:"setSize",value:function(t,e){this._width=t,this._height=e,this._mainView.setSize(t,e),this._floatLayerView.setSize(t,e)}},{key:"invalidate",value:function(t){switch(t){case 2:this._floatLayerView.flush();break;case 3:case 4:this._mainView.flush(),this._floatLayerView.flush()}}},{key:"getImage",value:function(t,e){var i=document.createElement("canvas"),a=i.getContext("2d"),n=st(a);return i.style.width="".concat(this._width,"px"),i.style.height="".concat(this._height,"px"),i.width=this._width*n,i.height=this._height*n,a.scale(n,n),a.drawImage(this._mainView.getImage(),0,0,this._width,this._height),e&&this._expandView&&a.drawImage(this._expandView.getImage(),0,0,this._width,this._height),t&&a.drawImage(this._floatLayerView.getImage(),0,0,this._width,this._height),i}}]),t}(),vt=function(){function t(e,a){i(this,t),this._chartData=a,this._initCanvas(e)}return n(t,[{key:"_initCanvas",value:function(t){this._canvas=document.createElement("canvas"),this._canvas.style.position="absolute",this._canvas.style.right="0",this._canvas.style.left="0",this._canvas.style.zIndex="2",this._ctx=this._canvas.getContext("2d"),t.appendChild(this._canvas)}},{key:"_redraw",value:function(t){this._ctx.clearRect(0,0,this._width,this._height),t&&t(),this._draw()}},{key:"_draw",value:function(){}},{key:"setSize",value:function(t,e){var i=this;this._redraw((function(){var a=st(i._ctx);i._width=t,i._height=e,i._canvas.style.top="0",i._canvas.style.width="".concat(t,"px"),i._canvas.style.height="".concat(e,"px"),i._canvas.width=t*a,i._canvas.height=e*a,i._ctx.scale(a,a)}))}},{key:"flush",value:function(){var t,e,i=this;this.requestAnimationId&&(t=this.requestAnimationId,window.cancelAnimationFrame||clearTimeout(t),window.cancelAnimationFrame(t)),this.requestAnimationId=(e=function(){i._redraw()},window.requestAnimationFrame?window.requestAnimationFrame(e):window.setTimeout((function(){e()}),1e3/60))}},{key:"getImage",value:function(){return this._canvas}}]),t}(),ft=function(t){function e(t,a,n,r,s){var h;return i(this,e),(h=c(this,o(e).call(this,t,a)))._xAxis=n,h._yAxis=r,h._additionalDataProvider=s,h}return s(e,t),n(e,[{key:"_draw",value:function(){this._drawGrid(),this._drawTechnicalIndicator()}},{key:"_drawGrid",value:function(){var t=this,e=this._chartData.styleOptions().grid;if(e.display){var i=e.horizontal;i.display&&(this._ctx.strokeStyle=i.color,this._ctx.lineWidth=i.size,i.style===m&&this._ctx.setLineDash(i.dashValue),this._yAxis.ticks().forEach((function(e){ht(t._ctx,e.y,0,t._width)})));var a=e.vertical;a.display&&(this._ctx.strokeStyle=a.color,this._ctx.lineWidth=a.size,this._ctx.setLineDash(a.style===m?a.dashValue:[]),this._xAxis.ticks().forEach((function(e){lt(t._ctx,e.x,0,t._height)}))),this._ctx.setLineDash([])}}},{key:"_drawTechnicalIndicator",value:function(){var t=this,e=this._additionalDataProvider.technicalIndicatorType(),i=this._chartData.technicalIndicatorParamOptions(),a=[],n=this._chartData.styleOptions().technicalIndicator,r=this._chartData.dataList();this._drawGraphics((function(s,o,c,h){var l=A(c,e,i).values,u=function(t){return function(t){if(Array.isArray(t)){for(var e=0,i=Array(t.length);t.length>e;e++)i[e]=t[e];return i}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}(l);switch(e){case P.MA:case P.EMA:case P.BOLL:t._drawTechnicalIndicatorOhlc(o,s,h,n,c,t._yAxis.isCandleStickYAxis());break;case P.MACD:u.splice(u.length-1,1);var d=l[l.length-1];d>0?(t._ctx.strokeStyle=n.bar.upColor,t._ctx.fillStyle=n.bar.upColor):0>d?(t._ctx.strokeStyle=n.bar.downColor,t._ctx.fillStyle=n.bar.downColor):(t._ctx.strokeStyle=n.bar.noChangeColor,t._ctx.fillStyle=n.bar.noChangeColor);var _=F(r,o-1,{}),v=F(_,"macd",{}).macd;t._drawBars(s,h,d,!((v||0===v)&&d>v));break;case P.VOL:u.splice(u.length-1,1);var f=c.close,p=c.open;t._ctx.fillStyle=f>p?n.bar.upColor:p>f?n.bar.downColor:n.bar.noChangeColor,t._drawBars(s,h,l[l.length-1],!0);break;case P.SAR:u.splice(0,1);var y=l[0];if(y||0===y){var m=t._yAxis.convertToPixel(y);t._ctx.strokeStyle=(c.high+c.low)/2>y?n.bar.upColor:n.bar.downColor,t._ctx.beginPath(),t._ctx.arc(s,m,h,2*Math.PI,0,!0),t._ctx.stroke(),t._ctx.closePath()}t._drawTechnicalIndicatorOhlc(o,s,h,n,c,t._yAxis.isCandleStickYAxis())}t._prepareLinePoints(s,u,a)}),(function(){t._drawLines(a,n)}))}},{key:"_drawTechnicalIndicatorOhlc",value:function(t,e,i,a,n,r){r||this._drawOhlc(i,e,n,a.bar.upColor,a.bar.downColor,a.bar.noChangeColor)}},{key:"_prepareLinePoints",value:function(t,e,i){for(var a=0;e.length>a;a++){var n=this._yAxis.convertToPixel(e[a]);i[a]?i[a].push({x:t,y:n}):i[a]=[{x:t,y:n}]}}},{key:"_drawLines",value:function(t,e){var i=this,a=e.line.colors,n=t.length,r=(a||[]).length;this._ctx.lineWidth=e.line.size,ut(this._ctx,(function(){for(var e=0;n>e;e++){var s=t[e];if(s.length>0){i._ctx.strokeStyle=a[e%r],i._ctx.beginPath(),i._ctx.moveTo(s[0].x,s[0].y);for(var o=1;s.length>o;o++)i._ctx.lineTo(s[o].x,s[o].y);i._ctx.stroke(),i._ctx.closePath()}}}))}},{key:"_drawBars",value:function(t,e,i,a){if(i||0===i){this._ctx.lineWidth=1;var n=this._yAxis.convertToPixel(i),r=this._yAxis.convertToPixel(0),s=n;0>i&&(s=r);var o=Math.abs(r-n);1>o&&(o=1,s=0>i?s+1:s-1),a?this._ctx.fillRect(t-e,s,2*e,o):this._ctx.strokeRect(t-e+.5,s,2*e-1,o)}}},{key:"_drawOhlc",value:function(t,e,i,a,n,r){var s=i.open,o=i.close,c=this._yAxis.convertToPixel(s),h=this._yAxis.convertToPixel(o),l=this._yAxis.convertToPixel(i.high),u=this._yAxis.convertToPixel(i.low);this._ctx.fillStyle=o>s?a:s>o?n:r,this._ctx.fillRect(e-.5,l,1,u-l),this._ctx.fillRect(e-t,c-.5,t,1),this._ctx.fillRect(e,h-.5,t,1)}},{key:"_drawGraphics",value:function(t,e){for(var i=this._chartData.dataList(),a=i.length,n=this._chartData.barSpace(),r=this._chartData.dataSpace(),s=n/2,o=this._chartData.offsetRightBarCount(),c=this._chartData.to(),h=this._chartData.from();c>h;h++)t&&t(this._width-(a+o-h-.5)*r+s,h,i[h],s,n);e&&e()}}]),e}(vt),pt=function(t){function e(t,a,n,r,s){var h;return i(this,e),(h=c(this,o(e).call(this,t,a)))._xAxis=n,h._yAxis=r,h._additionalDataProvider=s,h}return s(e,t),n(e,[{key:"_draw",value:function(){var t,e=this._chartData.crossHairPoint(),i=this._chartData.dataList(),a=i[t=e?this._xAxis.convertFromPixel(e.x):i.length-1];if(!a){var n=this._chartData.to();t>n-1?a=i[n-1]:0>t&&(a=i[0])}if(a){var r=this._xAxis.convertToPixel(t);this._drawCrossHairHorizontalLine(),this._drawCrossHairVerticalLine(a,r);var s=this._chartData.styleOptions().floatLayer.prompt.displayRule;(s===T||"follow_cross"===s&&this._chartData.crossHairSeriesTag())&&this._drawPrompt(a,r,t>0&&i.length>t)}}},{key:"_drawPrompt",value:function(t,e,i){this._drawTechnicalIndicatorPrompt(t,e,i)}},{key:"_drawCrossHairHorizontalLine",value:function(){if(this._chartData.crossHairSeriesTag()===this._additionalDataProvider.tag()){var t=this._chartData.styleOptions().floatLayer.crossHair,e=t.horizontal,i=e.line;if(t.display&&e.display&&i.display){var a=this._chartData.crossHairPoint();a&&(this._ctx.lineWidth=i.size,this._ctx.strokeStyle=i.color,i.style===m&&this._ctx.setLineDash(i.dashValue),ht(this._ctx,a.y,0,this._width),this._ctx.setLineDash([]))}}}},{key:"_drawCrossHairVerticalLine",value:function(t,e){if(this._chartData.crossHairSeriesTag()){var i=this._chartData.styleOptions().floatLayer.crossHair,a=i.vertical,n=a.line;i.display&&a.display&&n.display&&(this._ctx.lineWidth=n.size,this._ctx.strokeStyle=n.color,n.style===m&&this._ctx.setLineDash(n.dashValue),lt(this._ctx,e,0,this._height),this._ctx.setLineDash([]))}}},{key:"_drawTechnicalIndicatorPrompt",value:function(t,e,i){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,n=this._chartData.styleOptions().technicalIndicator,r=this._getTechnicalIndicatorPromptData(t),s=n.line.colors;this._drawTechnicalIndicatorPromptText(r,s,a),this._drawTechnicalIndicatorPromptPoint(r.values,s,e,i)}},{key:"_drawTechnicalIndicatorPromptText",value:function(t,e,i){var a=this._chartData.styleOptions().floatLayer.prompt.technicalIndicator.text,n=t.name,r=t.labels,s=t.values,o=a.marginLeft,c=a.marginRight,h=o,l=a.marginTop+i,u=a.size,d=a.color,_=e.length;this._ctx.textBaseline="top",this._ctx.font=ct(u,a.family);var v=ot(this._ctx,n);this._ctx.fillStyle=d,this._ctx.fillText(n,h,l),h+=o+v;for(var f=0;r.length>f;f++){var p="".concat(r[f].toUpperCase(),": ").concat(s[f]||"--"),y=ot(this._ctx,p);this._ctx.fillStyle=e[f%_]||d,this._ctx.fillText(p,h,l),h+=o+c+y}}},{key:"_drawTechnicalIndicatorPromptPoint",value:function(t,e,i,a){var n=this._chartData.styleOptions().floatLayer.prompt.technicalIndicator.point;if(n.display){var r=this._additionalDataProvider.technicalIndicatorType();if(this._chartData.crossHairSeriesTag()&&r!==P.SAR&&a)for(var s=e.length,o=r===P.MACD||r===P.VOL?t.length-1:t.length,c=n.radius,h=0;o>h;h++){var l=t[h];if(l||0===l){var u=this._yAxis.convertToPixel(l);this._ctx.fillStyle=e[h%s],this._ctx.beginPath(),this._ctx.arc(i,u,c,0,2*Math.PI),this._ctx.closePath(),this._ctx.fill()}}}}},{key:"_getTechnicalIndicatorPromptData",value:function(t){var e=this._chartData.technicalIndicatorParamOptions(),i=this._additionalDataProvider.technicalIndicatorType(),a=A(t,i,e),n=this._chartData.technicalIndicatorParamOptions()[i]||[],r=a.keys,s=a.values,o="";if(r.length>0){o="".concat(i),n&&d(n)&&n.length>0&&(o="".concat(o,"(").concat(n.join(","),")"));var c=this._chartData.precisionOptions()[i];s.forEach((function(t,e){s[e]=W(t,c)}))}return{labels:r,values:s,name:o}}}]),e}(vt),yt=function(t){function e(){return i(this,e),c(this,o(e).apply(this,arguments))}return s(e,t),n(e,[{key:"_createMainView",value:function(t,e){return new ft(t,e.chartData,e.xAxis,e.yAxis,e.additionalDataProvider)}},{key:"_createFloatLayerView",value:function(t,e){return new pt(t,e.chartData,e.xAxis,e.yAxis,e.additionalDataProvider)}}]),e}(_t),mt=function(t){function e(t,a,n,r){var s;return i(this,e),(s=c(this,o(e).call(this,t,a)))._yAxis=n,s._additionalDataProvider=r,s}return s(e,t),n(e,[{key:"_draw",value:function(){var t=this._chartData.styleOptions().yAxis;t.display&&(this._drawAxisLine(t),this._drawTickLines(t),this._drawTickLabels(t),this._drawTechnicalIndicatorLastValue(t),this._drawLastPriceLabel(t))}},{key:"_drawAxisLine",value:function(t){var e,i=t.axisLine;i.display&&(this._ctx.strokeStyle=i.color,this._ctx.lineWidth=i.size,e=this._isDrawFromStart(t)?0:this._width-1,lt(this._ctx,e,0,this._height))}},{key:"_drawTickLines",value:function(t){var e=this,i=t.tickLine;if(i.display){this._ctx.lineWidth=i.size,this._ctx.strokeStyle=i.color;var a,n,r=i.length;this._isDrawFromStart(t)?(a=0,t.axisLine.display&&(a+=t.axisLine.size),n=a+r):(a=this._width,t.axisLine.display&&(a-=t.axisLine.size),n=a-r),this._yAxis.ticks().forEach((function(t){ht(e._ctx,t.y,a,n)}))}}},{key:"_drawTickLabels",value:function(t){var e=this,i=t.tickText;if(i.display){var a,n=t.tickLine,r=n.display,s=n.length,o=i.margin;this._isDrawFromStart(t)?(a=o,t.axisLine.display&&(a+=t.axisLine.size),r&&(a+=s),this._ctx.textAlign="left"):(a=this._width-o,t.axisLine.display&&(a-=t.axisLine.size),r&&(a-=s),this._ctx.textAlign="right"),this._ctx.textBaseline="middle",this._ctx.font=ct(i.size,i.family),this._ctx.fillStyle=i.color,this._yAxis.ticks().forEach((function(t){e._ctx.fillText(t.v,a,t.y)})),this._ctx.textAlign="left"}}},{key:"_drawTechnicalIndicatorLastValue",value:function(t){var e=this._chartData.styleOptions().technicalIndicator,i=e.lastValueMark,a=this._chartData.dataList(),n=a[a.length-1];if(i.display&&n)for(var r=this._chartData.technicalIndicatorParamOptions(),s=this._additionalDataProvider.technicalIndicatorType(),o=A(n,s,r).values,c=e.line.colors||[],h=c.length,l=o.length,u=0;l>u;u++){var d=c[u%h];this._drawMarkLabel(t,o[u],this._chartData.precisionOptions()[s],i.textSize,i.textFamily,i.textColor,d,i.textPaddingLeft,i.textPaddingTop,i.textPaddingRight,i.textPaddingBottom)}}},{key:"_drawLastPriceLabel",value:function(t){if(this._yAxis.isCandleStickYAxis()){var e=this._chartData.styleOptions().candleStick.priceMark,i=e.last,a=this._chartData.dataList(),n=a.length;if(e.display&&i.display&&i.text.display&&0!==n){var r,s=a[n-1],o=s.close,c=s.open;r=o>c?i.upColor:c>o?i.downColor:i.noChangeColor;var h=i.text;this._drawMarkLabel(t,o,this._chartData.precisionOptions().price,h.size,h.family,h.color,r,h.paddingLeft,h.paddingTop,h.paddingRight,h.paddingBottom)}}}},{key:"_drawMarkLabel",value:function(t,e,i,a,n,r,s,o,c,h,l){var u,d=this._yAxis.convertToPixel(e);if(d=+Math.max(.05*this._height,Math.min(d,.98*this._height)).toFixed(0),this._yAxis.isPercentageYAxis()){var _=this._chartData.dataList()[this._chartData.from()].close;u="".concat(((e-_)/_*100).toFixed(2),"%")}else u=W(e,i);this._ctx.font=ct(a,n);var v,f=ot(this._ctx,u)+o+h,p=c+a+l;v=this._isDrawFromStart(t)?0:this._width-f,this._ctx.fillStyle=s,this._ctx.fillRect(v,d-c-a/2,f,p),this._ctx.fillStyle=r,this._ctx.textBaseline="middle",this._ctx.fillText(u,v+o,d)}},{key:"_isDrawFromStart",value:function(t){return t.position===x&&t.tickText.position===k||t.position===g&&t.tickText.position===w}}]),e}(vt),xt=function(t){function e(t,a,n,r){var s;return i(this,e),(s=c(this,o(e).call(this,t,a)))._yAxis=n,s._additionalDataProvider=r,s}return s(e,t),n(e,[{key:"_draw",value:function(){this._drawCrossHairLabel()}},{key:"_drawCrossHairLabel",value:function(){if(this._chartData.crossHairSeriesTag()===this._additionalDataProvider.tag()&&0!==this._chartData.dataList().length){var t=this._chartData.styleOptions().floatLayer.crossHair,e=t.horizontal,i=e.text;if(t.display&&e.display&&i.display){var a=this._chartData.crossHairPoint();if(a){var n,r=this._yAxis.convertFromPixel(a.y);if(this._yAxis.isPercentageYAxis()){var s=this._chartData.dataList()[this._chartData.from()].close;n="".concat(((r-s)/s*100).toFixed(2),"%")}else n=W(r,this._chartData.precisionOptions()[this._yAxis.isCandleStickYAxis()?"price":this._additionalDataProvider.technicalIndicatorType()]);var o=i.size;this._ctx.font=ct(o,i.family);var c,h=ot(this._ctx,n),l=i.paddingLeft,u=i.paddingTop,d=i.borderSize,_=h+2*d+l+i.paddingRight,v=o+2*d+u+i.paddingBottom,f=this._chartData.styleOptions().yAxis;c=f.position===x&&f.tickText.position===k||f.position===g&&f.tickText.position===w?0:this._width-_;var p=a.y-d-u-o/2;this._ctx.fillStyle=i.backgroundColor,this._ctx.fillRect(c,p,_,v),this._ctx.lineWidth=d,this._ctx.strokeStyle=i.borderColor,this._ctx.strokeRect(c,p,_,v),this._ctx.textBaseline="middle",this._ctx.fillStyle=i.color,this._ctx.fillText(n,c+d+l,a.y)}}}}}]),e}(vt),gt=function(t){function e(){return i(this,e),c(this,o(e).apply(this,arguments))}return s(e,t),n(e,[{key:"_createMainView",value:function(t,e){return new mt(t,e.chartData,e.yAxis,e.additionalDataProvider)}},{key:"_createFloatLayerView",value:function(t,e){return new xt(t,e.chartData,e.yAxis,e.additionalDataProvider)}}]),e}(_t),kt=function(){function t(e){i(this,t),this._chartData=e,this._width=0,this._height=0,this._minValue=0,this._maxValue=0,this._range=0,this._ticks=[]}return n(t,[{key:"setSize",value:function(t,e){this._width=t,this._height=e}},{key:"ticks",value:function(){return this._ticks}},{key:"computeAxis",value:function(){var t=this._computeMinMaxValue(),e=t.max,i=t.range;this._minValue=t.min,this._maxValue=e,this._range=i,this._ticks=this._computeOptimalTicks(this._computeTicks())}},{key:"_computeMinMaxValue",value:function(){}},{key:"_computeOptimalTicks",value:function(t){}},{key:"_computeTicks",value:function(){var t=[];if(this._range>=0){var e=+this._nice(this._range/6),i=this._getIntervalPrecision(e),a=+this._round(Math.ceil(this._minValue/e)*e,i),n=+this._round(Math.floor(this._maxValue/e)*e,i),r=0,s=a;if(0!==e)for(;+n>=s;)++r,s+=e;s=a;for(var o=0;r>o;o++)t[o]={v:s.toFixed(i)},s+=e}return t}},{key:"_nice",value:function(t){var e=Math.floor(Math.log(t)/Math.log(10)),i=Math.pow(10,e),a=t/i;return t=(1.5>a?1:2.5>a?2:4>a?3:7>a?5:8)*i,-20>e?t:+t.toFixed(0>e?-e:0)}},{key:"_getIntervalPrecision",value:function(t){var e=""+t,i=e.indexOf("e");if(i>0){var a=+e.slice(i+1);return 0>a?-a:0}var n=e.indexOf(".");return 0>n?0:e.length-1-n}},{key:"_round",value:function(t,e){return null==e&&(e=10),(+t).toFixed(e=Math.min(Math.max(0,e),20))}}]),t}(),wt=function(t){function e(t,a){var n;return i(this,e),(n=c(this,o(e).call(this,t)))._isCandleStickYAxis=a,n}return s(e,t),n(e,[{key:"_compareMinMax",value:function(t,e,i){var a=F(t,e.toLowerCase(),{});return Object.keys(a).forEach((function(t){var e=a[t];(e||0===e)&&(i[0]=Math.min(i[0],e),i[1]=Math.max(i[1],e))})),e!==P.BOLL&&e!==P.SAR||(i[0]=Math.min(i[0],t.low),i[1]=Math.max(i[1],t.high)),i}},{key:"_computeMinMaxValue",value:function(){var t=this._minValue,e=this._maxValue;if(t===1/0||e===-1/0)return{min:0,max:0,range:0};var i=Math.abs(e-t);return{min:t-=i/100*10,max:e+=i/100*20,range:i=Math.abs(e-t)}}},{key:"_computeOptimalTicks",value:function(t){var e,i=[],a=t.length;if(a>0){var n=this._chartData.styleOptions().xAxis.tickText.size,r=this._innerConvertToPixel(+t[0].v),s=1;if(a>1){var o=this._innerConvertToPixel(+t[1].v),c=Math.abs(o-r);2*n>c&&(s=Math.ceil(2*n/c))}for(var h=this.isPercentageYAxis(),l=0;a>l;l+=s){var u=t[l].v,d=this._innerConvertToPixel(+u);d>n&&this._height-n>d&&i.push({v:h?"".concat((+u).toFixed(2),"%"):(e=u,f(+e)?e>5e4?"".concat(+(e/1e3).toFixed(1),"K"):e>5e6?"".concat(+(e/1e6).toFixed(3),"M"):"".concat(e):"--"),y:d})}}return i}},{key:"calcMinMaxValue",value:function(t,e){var i=this._chartData.dataList(),a=this._chartData.from(),n=this._chartData.to(),r=this._chartData.styleOptions().realTime.averageLine.display,s=[1/0,-1/0];if(e)for(var o=a;n>o;o++){var c=i[o],h=[c.close,s[0]],l=[c.close,s[1]];r&&(h.push(c.average),l.push(c.average)),s[0]=Math.min.apply(null,h),s[1]=Math.max.apply(null,l)}else{for(var u=a;n>u;u++){var d=i[u];this._compareMinMax(d,t,s),this._isCandleStickYAxis&&(s[0]=Math.min(d.low,s[0]),s[1]=Math.max(d.high,s[1]))}t===P.VOL&&(s[0]=0)}if(s[0]!==1/0&&s[1]!==-1/0)if(s[0]=Math.round(1e6*s[0])/1e6,s[1]=Math.round(1e6*s[1])/1e6,this.isPercentageYAxis()){var _=i[a].close;this._minValue=(s[0]-_)/_*100,this._maxValue=(s[1]-_)/_*100,this._minValue===this._maxValue&&(this._minValue-=10,this._maxValue+=10)}else this._minValue=s[0],this._maxValue=s[1],this._minValue===this._maxValue&&(this._minValue-=1,0>this._minValue?(this._minValue=0,this._maxValue=Math.max(1,2*this._maxValue)):this._maxValue+=1)}},{key:"_innerConvertToPixel",value:function(t){return Math.round((1-(t-this._minValue)/this._range)*this._height)}},{key:"isCandleStickYAxis",value:function(){return this._isCandleStickYAxis}},{key:"isPercentageYAxis",value:function(){return this._isCandleStickYAxis&&"percentage"===this._chartData.styleOptions().yAxis.type}},{key:"convertFromPixel",value:function(t){var e=(1-t/this._height)*this._range+this._minValue;if(this.isPercentageYAxis()){var i=this._chartData.dataList()[this._chartData.from()].close;return i*e/100+i}return e}},{key:"convertToPixel",value:function(t){var e=t;if(this.isPercentageYAxis()){var i=this._chartData.dataList()[this._chartData.from()].close;e=(t-i)/i*100}return this._innerConvertToPixel(e)}}]),e}(kt),St=function(t){function e(t){var a;return i(this,e),(a=c(this,o(e).call(this,t)))._technicalIndicatorType=t.technicalIndicatorType||P.MACD,a._calcTechnicalIndicator(),a}return s(e,t),n(e,[{key:"_initBefore",value:function(t){this._tag=t.tag,this._yAxis=this._createYAxis(t)}},{key:"_createYAxis",value:function(t){return new wt(t.chartData,!1)}},{key:"_createMainWidget",value:function(t,e){return new yt({container:t,chartData:e.chartData,xAxis:e.xAxis,yAxis:this._yAxis,additionalDataProvider:{technicalIndicatorType:this.technicalIndicatorType.bind(this),tag:this.tag.bind(this)}})}},{key:"_createYAxisWidget",value:function(t,e){return new gt({container:t,chartData:e.chartData,yAxis:this._yAxis,additionalDataProvider:{technicalIndicatorType:this.technicalIndicatorType.bind(this),tag:this.tag.bind(this)}})}},{key:"_computeAxis",value:function(){this._yAxis.calcMinMaxValue(this._technicalIndicatorType,this._isRealTime()),this._yAxis.computeAxis()}},{key:"_isRealTime",value:function(){return!1}},{key:"_calcTechnicalIndicator",value:function(){this._chartData.calcTechnicalIndicator(this._technicalIndicatorType)&&this.invalidate(4)}},{key:"tag",value:function(){return this._tag}},{key:"setSize",value:function(t,i){this._yAxis.setSize(i.width,i.height),this._computeAxis(),h(o(e.prototype),"setSize",this).call(this,t,i)}},{key:"yAxis",value:function(){return this._yAxis}},{key:"technicalIndicatorType",value:function(){return this._technicalIndicatorType}},{key:"setTechnicalIndicatorType",value:function(t){this._technicalIndicatorType!==t&&(this._technicalIndicatorType=t,this._calcTechnicalIndicator())}}]),e}(dt),Mt=function(t){function e(){return i(this,e),c(this,o(e).apply(this,arguments))}return s(e,t),n(e,[{key:"_draw",value:function(){this._drawGrid(),this._additionalDataProvider.chartType()===S?this._drawRealTime():(this._drawCandleStick(),this._drawTechnicalIndicator(),this._drawHighestPriceMark(),this._drawLowestPriceMark()),this._drawLastPriceLine()}},{key:"_drawRealTime",value:function(){var t=this,e=[],i=[],a=[],n=this._chartData.from();this._drawGraphics((function(r,s,o,c){var h=o.average,l=t._yAxis.convertToPixel(o.close),u=t._yAxis.convertToPixel(h);if((h||0===h)&&a.push({x:r,y:u}),s===n){var d=r-c;i.push({x:d,y:t._height}),i.push({x:d,y:l}),e.push({x:d,y:l})}e.push({x:r,y:l}),i.push({x:r,y:l})}),(function(){var n=i.length;if(n>0){var r=i[n-1],s=t._chartData.barSpace()/2,o=r.x+s;e.push({x:o,y:r.y}),i.push({x:o,y:r.y}),i.push({x:o,y:t._height})}var c=t._chartData.styleOptions().realTime,h=c.timeLine;if(e.length>0&&(t._ctx.lineWidth=h.size,t._ctx.strokeStyle=h.color,ut(t._ctx,(function(){t._ctx.beginPath(),t._ctx.moveTo(e[0].x,e[0].y);for(var i=1;e.length>i;i++)t._ctx.lineTo(e[i].x,e[i].y);t._ctx.stroke(),t._ctx.closePath()}))),i.length>0){t._ctx.fillStyle=h.areaFillColor,t._ctx.beginPath(),t._ctx.moveTo(i[0].x,i[0].y);for(var l=1;i.length>l;l++)t._ctx.lineTo(i[l].x,i[l].y);t._ctx.closePath(),t._ctx.fill()}var u=c.averageLine;u.display&&a.length>0&&(t._ctx.lineWidth=u.size,t._ctx.strokeStyle=u.color,ut(t._ctx,(function(){t._ctx.beginPath(),t._ctx.moveTo(a[0].x,a[0].y);for(var e=1;a.length>e;e++)t._ctx.lineTo(a[e].x,a[e].y);t._ctx.stroke(),t._ctx.closePath()})))}))}},{key:"_drawCandleStick",value:function(){var t=this,e=[],i=-1/0,a=-1,n=1/0,r=-1,s=this._chartData.styleOptions().candleStick;this._drawGraphics((function(o,c,h,l,u){var d=h.open,_=h.close,v=h.high,f=h.low;if(v>i&&(i=v,a=o),n>f&&(n=f,r=o),"ohlc"!==s.bar.style){_>d?(t._ctx.strokeStyle=s.bar.upColor,t._ctx.fillStyle=s.bar.upColor):d>_?(t._ctx.strokeStyle=s.bar.downColor,t._ctx.fillStyle=s.bar.downColor):(t._ctx.strokeStyle=s.bar.noChangeColor,t._ctx.fillStyle=s.bar.noChangeColor);var p=t._yAxis.convertToPixel(d),y=t._yAxis.convertToPixel(_),m=t._yAxis.convertToPixel(v),x=t._yAxis.convertToPixel(f),g=[],k=[];switch(g[0]=m,k[1]=x,p>y?(g[1]=y,k[0]=p,e=[o-l,y,u,p-y]):y>p?(g[1]=p,k[0]=y,e=[o-l,p,u,y-p]):(g[1]=p,k[0]=y,e=[o-l,p,u,1]),t._ctx.fillRect(o-.5,g[0],1,g[1]-g[0]+1),t._ctx.fillRect(o-.5,k[0],1,k[1]-k[0]+1),1>e[3]&&(e[3]=1),s.bar.style){case D:t._ctx.fillRect(e[0],e[1],e[2],e[3]);break;case"stroke":t._ctx.strokeRect(e[0]+.5,e[1],e[2]-1,e[3]);break;case"up_stroke":_>d?t._ctx.strokeRect(e[0]+.5,e[1],e[2]-1,e[3]):t._ctx.fillRect(e[0],e[1],e[2],e[3]);break;case"down_stroke":_>d?t._ctx.fillRect(e[0],e[1],e[2],e[3]):t._ctx.strokeRect(e[0],e[1],e[2],e[3])}}else t._drawOhlc(l,o,h,s.bar.upColor,s.bar.downColor,s.bar.noChangeColor)})),this._highestMarkData={x:a,price:i},this._lowestMarkData={x:r,price:n}}},{key:"_drawHighestPriceMark",value:function(t){if(this._highestMarkData){var e=this._highestMarkData.price,i=this._chartData.styleOptions().candleStick.priceMark,a=i.high;e!==-1/0&&i.display&&a.display&&this._drawLowestHighestPriceMark(a,this._highestMarkData.x,e,!0,this._chartData.precisionOptions().price)}}},{key:"_drawLowestPriceMark",value:function(){if(this._lowestMarkData){var t=this._lowestMarkData.price,e=this._chartData.styleOptions().candleStick.priceMark,i=e.low;t!==1/0&&e.display&&i.display&&this._drawLowestHighestPriceMark(i,this._lowestMarkData.x,t,!1,this._chartData.precisionOptions().price)}}},{key:"_drawLowestHighestPriceMark",value:function(t,e,i,a,n){var r=this,s=this._yAxis.convertToPixel(i),o=e,c=s+(a?-2:2);this._ctx.textAlign="left",this._ctx.lineWidth=1,this._ctx.strokeStyle=t.color,this._ctx.fillStyle=t.color,ut(this._ctx,(function(){r._ctx.beginPath(),r._ctx.moveTo(o,c),r._ctx.lineTo(o-2,c+(a?-2:2)),r._ctx.stroke(),r._ctx.closePath(),r._ctx.beginPath(),r._ctx.moveTo(o,c),r._ctx.lineTo(o+2,c+(a?-2:2)),r._ctx.stroke(),r._ctx.closePath()}));var h=c+(a?-5:5);lt(this._ctx,o,c,h),ht(this._ctx,h,o,o+5),this._ctx.font=ct(t.textSize,t.textFamily);var l=W(i,n);this._ctx.textBaseline="middle",this._ctx.fillText(l,o+5+t.textMargin,h)}},{key:"_drawLastPriceLine",value:function(){var t=this._chartData.dataList(),e=t.length,i=this._chartData.styleOptions().candleStick.priceMark,a=i.last;if(i.display&&a.display&&a.line.display&&0!==e){var n=t[e-1],r=n.close,s=n.open,o=this._yAxis.convertToPixel(r);o=+Math.max(.05*this._height,Math.min(o,.98*this._height)).toFixed(0);var c=a.line;this._ctx.strokeStyle=r>s?a.upColor:s>r?a.downColor:a.noChangeColor,this._ctx.lineWidth=c.size,c.style===m&&this._ctx.setLineDash(c.dashValue),ht(this._ctx,o,0,this._width),this._ctx.setLineDash([])}}}]),e}(ft),Dt=function(t){function a(){return i(this,a),c(this,o(a).apply(this,arguments))}return s(a,t),n(a,[{key:"_drawPrompt",value:function(t,e,i){var a=this._chartData.styleOptions().floatLayer.prompt.candleStick,n=this._getCandleStickPromptData(t,a);a.showType===C?(this._drawCandleStickStandardPromptText(a,n),this._additionalDataProvider.chartType()===M&&this._drawTechnicalIndicatorPrompt(t,e,i,a.text.size+a.text.marginTop)):this._drawCandleStickRectPromptText(t,e,a,n)}},{key:"_drawCandleStickStandardPromptText",value:function(t,i){var a=this,n=i,r=t.text.marginLeft,s=t.text.marginRight,o=t.text.size,c=t.text.color,h=t.labels;this._ctx.textBaseline="top",this._ctx.font=ct(o,t.text.family);var l=r,u=t.text.marginTop;h.forEach((function(t,i){var o=t?"".concat(t,": "):"",h=ot(a._ctx,o);a._ctx.fillStyle=c,a._ctx.fillText(o,l,u),l+=h;var d,_=n[i]||"--";"object"===e(_)?(d=_.value||"--",a._ctx.fillStyle=_.color||c):(a._ctx.fillStyle=c,d=_);var v=ot(a._ctx,d);a._ctx.fillText(d,l,u),l+=v+r+s}))}},{key:"_drawCandleStickRectPromptText",value:function(t,i,a,n){var r=this,s=a.labels,o=n,c=a.text.marginLeft,h=a.text.marginRight,l=a.text.marginTop,u=a.text.marginBottom,d=a.text.size,_=a.text.color;this._ctx.textBaseline="top",this._ctx.font=ct(d,a.text.family);var v=0;s.forEach((function(t,i){var a=o[i]||"--",n=a;"object"===e(a)&&(n=a.value||"--");var s="".concat(t,": ").concat(n),l=ot(r._ctx,s)+c+h;v=Math.max(v,l)}));var f=a.rect,p=f.borderSize,y=f.paddingLeft,m=f.paddingRight,x=f.paddingTop,g=f.left,k=f.right,w=2*p+x+f.paddingBottom+(u+l+d)*s.length,S=this._getTechnicalIndicatorPromptData(t),D=this._chartData.styleOptions().floatLayer.prompt.technicalIndicator,T=D.text.marginLeft,C=D.text.marginRight,b=D.text.marginTop,P=D.text.marginBottom,E=D.text.size,A=this._additionalDataProvider.chartType()===M,L=S.labels||[],I=S.values||[];A&&(this._ctx.font=ct(E,D.text.family),L.forEach((function(t,e){var i=I[e]||"--",a="".concat(t,": ").concat(i),n=ot(r._ctx,a)+T+C;v=Math.max(v,n)})),w+=(b+P+E)*L.length);var O,z=2*p+v+y+m;O=this._width/2>i?this._width-k-z:g;var R=f.top,H=f.borderRadius;if(this._ctx.lineWidth=p,this._ctx.strokeStyle=f.borderColor,this._ctx.fillStyle=f.fillColor,this._drawRoundRect(O,R,z,w,H),this._ctx.stroke(),this._drawRoundRect(O,R,z,w,H),this._ctx.fill(),A){var B=O+p+y+c,V=R+p+x;this._ctx.font=ct(d,a.text.family),s.forEach((function(t,i){V+=l,r._ctx.textAlign="left",r._ctx.fillStyle=_,r._ctx.fillText("".concat(t,": "),B,V);var a,n=o[i]||"--";r._ctx.fillStyle=n.color||_,a="object"===e(n)?n.value||"--":n,r._ctx.textAlign="right",r._ctx.fillText(a,O+z-p-h-m,V),V+=d+u}));var Y=this._chartData.styleOptions().technicalIndicator,F=Y.line.colors,G=O+p+y+T,N=F.length;this._ctx.font=ct(E,D.text.family),L.forEach((function(t,e){V+=b,r._ctx.textAlign="left",r._ctx.fillStyle=F[e%N]||Y.text.color,r._ctx.fillText("".concat(t.toUpperCase(),": "),G,V),r._ctx.textAlign="right",r._ctx.fillText(I[e]||"--",O+z-p-C-m,V),V+=E+P}))}this._ctx.textAlign="left"}},{key:"_drawRoundRect",value:function(t,e,i,a,n){this._ctx.beginPath(),this._ctx.moveTo(t+n,e),this._ctx.arcTo(t+i,e,t+i,e+a,n),this._ctx.arcTo(t+i,e+a,t,e+a,n),this._ctx.arcTo(t,e+a,t,e,n),this._ctx.arcTo(t,e,t+i,e,n),this._ctx.closePath()}},{key:"_getCandleStickPromptData",value:function(t,e){var i=this,a=e.values,n=[];if(a)n=_(a)?a(t)||[]:a;else{var r=this._chartData.precisionOptions();(n=[F(t,"timestamp"),F(t,"open"),F(t,"close"),F(t,"high"),F(t,"low"),F(t,"volume")]).forEach((function(t,e){switch(e){case 0:n[e]=N(t,"YYYY-MM-DD hh:mm",i._chartData.timezone());break;case n.length-1:n[e]=W(t,r.volume);break;default:n[e]=W(t,r.price)}}))}return n}}]),a}(pt);function Tt(t,e,i){var a=[];if(t&&e&&i.length>0){var n=t.x-e.x;if(0===n)i.forEach((function(t){a.push(t.y)}));else{var r=(t.y-e.y)/n,s=t.y-r*t.x;i.forEach((function(t){a.push(t.x*r+s)}))}}return a}function Ct(t,e,i){return!!(i&&t&&e)&&(t.x===e.x?1>Math.abs(i.x-t.x):t.y===e.y?1>Math.abs(i.y-t.y):1>Math.abs(i.y-Tt(t,e,[i])[0]))}function bt(t,e,i){return!!(i&&t&&e)&&!!Ct(t,e,i)&&(t.x===e.x?e.y>t.y?i.y>t.y-2:t.y+2>i.y:e.x>t.x?i.x>t.x-2:t.x+2>i.x)}function Pt(t,e,i){return!!(i&&t&&e)&&!!Ct(t,e,i)&&2>Math.abs(Math.sqrt(Math.pow(i.x-t.x,2)+Math.pow(i.y-t.y,2))+Math.sqrt(Math.pow(i.x-e.x,2)+Math.pow(i.y-e.y,2))-Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2)))}function Et(t,e,i){if(!i)return!1;var a=i.x-t.x,n=i.y-t.y;return!(a*a+n*n>e*e)}function At(t,e,i){var a=[];if(t.length>1)if(t[0].x===t[1].x){var n=e.height;if(a.push([{x:t[0].x,y:0},{x:t[0].x,y:n}]),t.length>2&&(a.push([{x:t[2].x,y:0},{x:t[2].x,y:n}]),i)){var r=t[0].x-t[2].x;a.push([{x:t[0].x+r,y:0},{x:t[0].x+r,y:n}])}}else{var s=e.width;if(t[0].y===t[1].y){if(a.push([{x:0,y:t[0].y},{x:s,y:t[0].y}]),t.length>2&&(a.push([{x:0,y:t[2].y},{x:s,y:t[2].y}]),i)){var o=t[0].y-t[2].y;a.push([{x:0,y:t[0].y+o},{x:s,y:t[0].y+o}])}}else{var c=(t[0].y-t[1].y)/(t[0].x-t[1].x),h=t[0].y-c*t[0].x;if(a.push([{x:0,y:0*c+h},{x:s,y:s*c+h}]),t.length>2){var l=t[2].y-c*t[2].x;if(a.push([{x:0,y:0*c+l},{x:s,y:s*c+l}]),i){var u=h+(h-l);a.push([{x:0,y:0*c+u},{x:s,y:s*c+u}])}}}}return a}function Lt(t,e){var i=[];if(t.length>0){var a=e.width;if(i.push([{x:0,y:t[0].y},{x:a,y:t[0].y}]),t.length>1){var n=t[0].y-t[1].y;i.push([{x:0,y:t[1].y+.786*n},{x:a,y:t[1].y+.786*n}]),i.push([{x:0,y:t[1].y+.618*n},{x:a,y:t[1].y+.618*n}]),i.push([{x:0,y:t[1].y+.5*n},{x:a,y:t[1].y+.5*n}]),i.push([{x:0,y:t[1].y+.382*n},{x:a,y:t[1].y+.382*n}]),i.push([{x:0,y:t[1].y+.236*n},{x:a,y:t[1].y+.236*n}]),i.push([{x:0,y:t[1].y},{x:a,y:t[1].y}])}}return i}function It(t){return t.getBoundingClientRect()||{left:0,top:0}}function Ot(t){return!!t.touches}function zt(t){t.cancelable&&t.preventDefault()}var Rt=!!navigator.maxTouchPoints||!!navigator.msMaxTouchPoints||"ontouchstart"in window||!!(window.DocumentTouch&&document instanceof window.DocumentTouch),Ht="onorientationchange"in window&&Rt;function Bt(t,e){var i=t.clientX-e.clientX,a=t.clientY-e.clientY;return Math.sqrt(i*i+a*a)}var Vt="mouse",Yt="touch",Ft=function(){function t(e,a,n){i(this,t),this._target=e,this._handler=a,this._options=n,this._clickCount=0,this._clickTimeoutId=null,this._longTapTimeoutId=null,this._longTapActive=!1,this._mouseMoveStartPosition=null,this._moveExceededManhattanDistance=!1,this._cancelClick=!1,this._unsubscribeOutsideEvents=null,this._unsubscribeMousemove=null,this._unsubscribeRoot=null,this._startPinchMiddlePoint=null,this._startPinchDistance=0,this._pinchPrevented=!1,this._preventDragProcess=!1,this._mousePressed=!1,this._init()}return n(t,[{key:"destroy",value:function(){null!==this._unsubscribeOutsideEvents&&(this._unsubscribeOutsideEvents(),this._unsubscribeOutsideEvents=null),null!==this._unsubscribeMousemove&&(this._unsubscribeMousemove(),this._unsubscribeMousemove=null),null!==this._unsubscribeRoot&&(this._unsubscribeRoot(),this._unsubscribeRoot=null),this._clearLongTapTimeout(),this._resetClickTimeout()}},{key:"_mouseEnterHandler",value:function(t){var e=this;this._unsubscribeMousemove&&this._unsubscribeMousemove();var i=this._mouseMoveHandler.bind(this),a=this._mouseWheelHandler.bind(this);this._unsubscribeMousemove=function(){e._target.removeEventListener("mousemove",i),e._target.removeEventListener("wheel",a)},this._target.addEventListener("mousemove",i),this._target.addEventListener("wheel",a,{passive:!1}),Ot(t)&&this._mouseMoveHandler(t);var n=this._makeCompatEvent(t);this._processEvent(n,this._handler.mouseEnterEvent)}},{key:"_resetClickTimeout",value:function(){null!==this._clickTimeoutId&&clearTimeout(this._clickTimeoutId),this._clickCount=0,this._clickTimeoutId=null}},{key:"_mouseMoveHandler",value:function(t){if(!this._mousePressed||Ot(t)){var e=this._makeCompatEvent(t);this._processEvent(e,this._handler.mouseMoveEvent)}}},{key:"_mouseWheelHandler",value:function(t){var e=this._makeCompatEvent(t);t.localX=e.localX,t.localY=e.localY,this._processEvent(t,this._handler.mouseWheelEvent)}},{key:"_mouseMoveWithDownHandler",value:function(t){if((!("button"in t)||0===t.button)&&null===this._startPinchMiddlePoint){var e=Ot(t);if(!this._preventDragProcess||!e){this._pinchPrevented=!0;var i=this._makeCompatEvent(t),a=this._mouseMoveStartPosition,n=Math.abs(a.x-i.pageX),r=Math.abs(a.y-i.pageY),s=n+r>5;if(s||!e){if(s&&!this._moveExceededManhattanDistance&&e){var o=.5*n;r>=o&&!this._options.treatVertTouchDragAsPageScroll||o>r&&!this._options.treatHorzTouchDragAsPageScroll||(this._preventDragProcess=!0)}s&&(this._moveExceededManhattanDistance=!0,this._cancelClick=!0,e&&this._clearLongTapTimeout()),this._preventDragProcess||(this._processEvent(i,this._handler.pressedMouseMoveEvent),e&&zt(t))}}}}},{key:"_mouseUpHandler",value:function(t){if(!("button"in t)||0===t.button){var e=this._makeCompatEvent(t);this._clearLongTapTimeout(),this._mouseMoveStartPosition=null,this._mousePressed=!1,this._unsubscribeRoot&&(this._unsubscribeRoot(),this._unsubscribeRoot=null),Ot(t)&&this._mouseLeaveHandler(t),this._processEvent(e,this._handler.mouseUpEvent),++this._clickCount,this._clickTimeoutId&&this._clickCount>1?(this._processEvent(e,this._handler.mouseDoubleClickEvent),this._resetClickTimeout()):this._cancelClick||this._processEvent(e,this._handler.mouseClickEvent),Ot(t)&&(zt(t),this._mouseLeaveHandler(t),0===t.touches.length&&(this._longTapActive=!1))}}},{key:"_clearLongTapTimeout",value:function(){null!==this._longTapTimeoutId&&(clearTimeout(this._longTapTimeoutId),this._longTapTimeoutId=null)}},{key:"_mouseDownHandler",value:function(t){if(!("button"in t)||0===t.button||2===t.button){var e=this._makeCompatEvent(t);if("button"in t&&2===t.button)this._processEvent(e,this._handler.mouseRightDownEvent);else{this._cancelClick=!1,this._moveExceededManhattanDistance=!1,this._preventDragProcess=!1,Ot(t)&&this._mouseEnterHandler(t),this._mouseMoveStartPosition={x:e.pageX,y:e.pageY},this._unsubscribeRoot&&(this._unsubscribeRoot(),this._unsubscribeRoot=null);var i=this._mouseMoveWithDownHandler.bind(this),a=this._mouseUpHandler.bind(this),n=this._target.ownerDocument.documentElement;this._unsubscribeRoot=function(){n.removeEventListener("touchmove",i),n.removeEventListener("touchend",a),n.removeEventListener("mousemove",i),n.removeEventListener("mouseup",a)},n.addEventListener("touchmove",i,{passive:!1}),n.addEventListener("touchend",a,{passive:!1}),this._clearLongTapTimeout(),Ot(t)&&1===t.touches.length?this._longTapTimeoutId=setTimeout(this._longTapHandler.bind(this,t),600):(n.addEventListener("mousemove",i),n.addEventListener("mouseup",a)),this._mousePressed=!0,this._processEvent(e,this._handler.mouseDownEvent),this._clickTimeoutId||(this._clickCount=0,this._clickTimeoutId=setTimeout(this._resetClickTimeout.bind(this),500))}}}},{key:"_init",value:function(){var t=this;this._target.addEventListener("mouseenter",this._mouseEnterHandler.bind(this)),this._target.addEventListener("touchcancel",this._clearLongTapTimeout.bind(this));var e=this._target.ownerDocument,i=function(e){t._handler.mouseDownOutsideEvent&&(e.target&&t._target.contains(e.target)||t._handler.mouseDownOutsideEvent())};this._unsubscribeOutsideEvents=function(){e.removeEventListener("mousedown",i),e.removeEventListener("touchstart",i)},e.addEventListener("mousedown",i),e.addEventListener("touchstart",i,{passive:!0}),this._target.addEventListener("mouseleave",this._mouseLeaveHandler.bind(this)),this._target.addEventListener("touchstart",this._mouseDownHandler.bind(this),{passive:!0}),Ht||this._target.addEventListener("mousedown",this._mouseDownHandler.bind(this)),this._initPinch(),this._target.addEventListener("touchmove",(function(){}),{passive:!1})}},{key:"_initPinch",value:function(){var t=this;void 0===this._handler.pinchStartEvent&&void 0===this._handler.pinchEvent&&void 0===this._handler.pinchEndEvent||(this._target.addEventListener("touchstart",(function(e){return t._checkPinchState(e.touches)}),{passive:!0}),this._target.addEventListener("touchmove",(function(e){if(2===e.touches.length&&null!==t._startPinchMiddlePoint&&void 0!==t._handler.pinchEvent){var i=Bt(e.touches[0],e.touches[1]);t._handler.pinchEvent(t._startPinchMiddlePoint,i/t._startPinchDistance),zt(e)}}),{passive:!1}),this._target.addEventListener("touchend",(function(e){t._checkPinchState(e.touches)})))}},{key:"_checkPinchState",value:function(t){1===t.length&&(this._pinchPrevented=!1),2!==t.length||this._pinchPrevented||this._longTapActive?this._stopPinch():this._startPinch(t)}},{key:"_startPinch",value:function(t){var e=It(this._target);this._startPinchMiddlePoint={x:(t[0].clientX-e.left+(t[1].clientX-e.left))/2,y:(t[0].clientY-e.top+(t[1].clientY-e.top))/2},this._startPinchDistance=Bt(t[0],t[1]),void 0!==this._handler.pinchStartEvent&&this._handler.pinchStartEvent(),this._clearLongTapTimeout()}},{key:"_stopPinch",value:function(){null!==this._startPinchMiddlePoint&&(this._startPinchMiddlePoint=null,void 0!==this._handler.pinchEndEvent&&this._handler.pinchEndEvent())}},{key:"_mouseLeaveHandler",value:function(t){this._unsubscribeMousemove&&this._unsubscribeMousemove();var e=this._makeCompatEvent(t);this._processEvent(e,this._handler.mouseLeaveEvent)}},{key:"_longTapHandler",value:function(t){var e=this._makeCompatEvent(t);this._processEvent(e,this._handler.longTapEvent),this._cancelClick=!0,this._longTapActive=!0}},{key:"_processEvent",value:function(t,e){e&&e.call(this._handler,t)}},{key:"_makeCompatEvent",value:function(t){var e;e="touches"in t&&t.touches.length?t.touches[0]:"changedTouches"in t&&t.changedTouches.length?t.changedTouches[0]:t;var i=It(this._target);return{clientX:e.clientX,clientY:e.clientY,pageX:e.pageX,pageY:e.pageY,screenX:e.screenX,screenY:e.screenY,localX:e.clientX-i.left,localY:e.clientY-i.top,ctrlKey:t.ctrlKey,altKey:t.altKey,shiftKey:t.shiftKey,metaKey:t.metaKey,type:t.type.startsWith("mouse")?Vt:Yt,target:e.target,view:t.view}}}]),t}();function Gt(t){return t.type===Yt}function Nt(t){return t.type===Vt}var Wt=function(){function t(e){i(this,t),this._chartData=e,this._seriesSize={}}return n(t,[{key:"_checkEventPointX",value:function(t){return t>0&&this._seriesSize.contentRight-this._seriesSize.contentLeft>t}},{key:"setSeriesSize",value:function(t){this._seriesSize=t}}]),t}(),Xt="step_1",jt="step_2",Ut="step_3",Kt="step_done",Jt=function(t){function a(t,e,n){var r;return i(this,a),(r=c(this,o(a).call(this,t)))._xAxis=e,r._yAxis=n,r._noneGraphicMarkMouseDownFlag=!1,r._noneGraphicMarkMouseDownActiveData={markKey:null,dataIndex:-1,onLine:!1,onCircle:!1,pointIndex:-1},r}return s(a,t),n(a,[{key:"mouseUpEvent",value:function(t){this._chartData.setDragGraphicMarkFlag(!1),this._noneGraphicMarkMouseDownFlag=!1,this._noneGraphicMarkMouseDownActiveData={markKey:null,dataIndex:-1,onLine:!1,onCircle:!1,pointIndex:-1}}},{key:"mouseDownEvent",value:function(t){if(this._checkEventPointX(t.localX)&&this._checkEventPointY(t.localY)){this._chartData.setGraphicMarkPoint({x:t.localX,y:t.localY});var e=this._chartData.graphicMarkType();switch(e){case j:case U:case K:case J:case Z:case q:case $:case Q:case tt:case et:case nt:this._twoStepGraphicMarkMouseDown(t,e);break;case it:case at:this._threeStepGraphicMarkMouseDown(t,e);break;case X:this._noneGraphicMarkMouseLeftDown(t)}}}},{key:"mouseRightDownEvent",value:function(t){if(this._chartData.graphicMarkType()===X){this._findNoneGraphicMarkMouseDownActiveData(t);var e=this._noneGraphicMarkMouseDownActiveData.markKey,i=this._noneGraphicMarkMouseDownActiveData.dataIndex;if(e&&-1!==i){var a=this._chartData.graphicMarkData(),n=a[e];n.splice(i,1),a[e]=n,this._chartData.setGraphicMarkData(a),this.mouseUpEvent(t)}}}},{key:"_twoStepGraphicMarkMouseDown",value:function(t,e){var i=this;this._graphicMarkMouseDown(t,e,(function(t){switch(t.drawStep){case Xt:t.drawStep=jt;break;case jt:t.drawStep=Kt,i._chartData.setGraphicMarkType(X)}}))}},{key:"_threeStepGraphicMarkMouseDown",value:function(t,e){var i=this;this._graphicMarkMouseDown(t,e,(function(t){switch(t.drawStep){case Xt:t.drawStep=jt;break;case jt:t.drawStep=Ut;break;case Ut:t.drawStep=Kt,i._chartData.setGraphicMarkType(X)}}))}},{key:"_graphicMarkMouseDown",value:function(t,e,i){var a=this._chartData.graphicMarkData(),n=a[e];if(2===t.button)n.splice(n.length-1,1),this._chartData.setGraphicMarkType(X);else{var r=n[n.length-1];i(r),n[n.length-1]=r}a[e]=n,this._chartData.setGraphicMarkData(a)}},{key:"_noneGraphicMarkMouseLeftDown",value:function(t){this._findNoneGraphicMarkMouseDownActiveData(t),this._noneGraphicMarkMouseDownActiveData.markKey&&-1!==this._noneGraphicMarkMouseDownActiveData.dataIndex&&this._noneGraphicMarkMouseDownActiveData.onCircle&&(this._noneGraphicMarkMouseDownFlag=!0,this._chartData.setDragGraphicMarkFlag(!0))}},{key:"_findNoneGraphicMarkMouseDownActiveData",value:function(t){for(var i=this,a={x:t.localX,y:t.localY},n=Object.keys(this._chartData.graphicMarkData()),r=function(t){var e=n[t];switch(e){case j:case et:if(i._realFindNoneGraphicMarkMouseDownActiveData(e,a,(function(t){return Ct(t[0],{x:i._seriesSize.contentRight,y:t[0].y},a)})))return{v:void 0};break;case U:if(i._realFindNoneGraphicMarkMouseDownActiveData(e,a,(function(t){return Ct(t[0],{x:t[0].x,y:i._seriesSize.tags[ce].contentBottom},a)})))return{v:void 0};break;case K:if(i._realFindNoneGraphicMarkMouseDownActiveData(e,a,(function(t){return Ct(t[0],t[1],a)})))return{v:void 0};break;case J:case Z:case q:if(i._realFindNoneGraphicMarkMouseDownActiveData(e,a,(function(t){return bt(t[0],t[1],a)})))return{v:void 0};break;case $:case Q:case tt:if(i._realFindNoneGraphicMarkMouseDownActiveData(e,a,(function(t){return Pt(t[0],t[1],a)})))return{v:void 0};break;case it:case at:case nt:if(i._realFindNoneGraphicMarkMouseDownActiveData(e,a,(function(t){var n=[],r={width:i._seriesSize.contentRight,height:i._seriesSize.tags[ce].contentBottom-i._seriesSize.tags[ce].contentTop};switch(e){case it:n=At(t,r,!0);break;case at:n=At(t,r);break;case nt:n=Lt(t,r)}for(var s=!1,o=0;n.length>o;o++){var c=n[o];if(s=Ct(c[0],c[1],a))return s}return s})))return{v:void 0}}},s=0;n.length>s;s++){var o=r(s);if("object"===e(o))return o.v}}},{key:"_realFindNoneGraphicMarkMouseDownActiveData",value:function(t,e,i){var a=this,n=this._chartData.graphicMarkData()[t],r=this._chartData.styleOptions().graphicMark;return n.forEach((function(n,s){var o=[],c=!1,h=-1;n.points.forEach((function(t,i){var n=a._xAxis.convertToPixel(t.xPos),s=a._yAxis.convertToPixel(t.price);o.push({x:n,y:s});var l=Et({x:n,y:s},r.point.radius,e);l&&(h=i),c||(c=l)}));var l=i(o,e);if(l||c)return a._noneGraphicMarkMouseDownActiveData={markKey:t,dataIndex:s,onLine:l,onCircle:c,pointIndex:h},!0})),!1}},{key:"mouseMoveEvent",value:function(t){if(this._checkEventPointX(t.localX)&&this._checkEventPointY(t.localY)){var e={x:t.localX,y:t.localY};if(this._chartData.setGraphicMarkPoint(e),!this._waitingForMouseMoveAnimationFrame){this._waitingForMouseMoveAnimationFrame=!0;var i=this._chartData.graphicMarkType();switch(i){case j:case U:case et:this._onePointGraphicMarkMouseMove(e,i);break;case K:case q:case tt:case nt:this._twoPointGraphicMarkMouseMove(e,i);break;case J:case $:this._twoPointGraphicMarkMouseMove(e,i,(function(t,e){t.points[0].price=e.price}));break;case Z:case Q:this._twoPointGraphicMarkMouseMove(e,i,(function(t,e){t.points[0].xPos=e.xPos}));break;case it:case at:this._threePointGraphicMarkMouseMove(e,i);break;case X:this._chartData.setGraphicMarkData(this._chartData.graphicMarkData())}this._waitingForMouseMoveAnimationFrame=!1}}}},{key:"pressedMouseMoveEvent",value:function(t){var e=this._noneGraphicMarkMouseDownActiveData.markKey,i=this._noneGraphicMarkMouseDownActiveData.dataIndex;if(e&&-1!==i){var a=this._chartData.graphicMarkData(),n=a[e],r={x:t.localX,y:t.localY};switch(e){case j:case U:case et:case K:case q:case tt:case it:case at:case nt:var s=this._noneGraphicMarkMouseDownActiveData.pointIndex;-1!==s&&(n[i].points[s].xPos=this._xAxis.convertFromPixel(r.x),n[i].points[s].price=this._yAxis.convertFromPixel(r.y));break;case J:case $:var o=this._noneGraphicMarkMouseDownActiveData.pointIndex;if(-1!==o){var c=this._yAxis.convertFromPixel(r.y);n[i].points[o].xPos=this._xAxis.convertFromPixel(r.x),n[i].points[0].price=c,n[i].points[1].price=c}break;case Z:case Q:var h=this._noneGraphicMarkMouseDownActiveData.pointIndex;if(-1!==h){var l=this._xAxis.convertFromPixel(r.x);n[i].points[0].xPos=l,n[i].points[1].xPos=l,n[i].points[h].price=this._yAxis.convertFromPixel(r.y)}}a[e]=n,this._chartData.setGraphicMarkPoint({x:t.localX,y:t.localY}),this._chartData.setGraphicMarkData(a)}}},{key:"_onePointGraphicMarkMouseMove",value:function(t,e){var i=this;this._graphicMarkMouseMove(t,e,(function(e,a){var n=i._xAxis.convertFromPixel(t.x),r=i._yAxis.convertFromPixel(t.y);switch(a.drawStep){case Kt:e.push({points:[{xPos:n,price:r}],drawStep:Xt});break;case Xt:case jt:a.points[0].xPos=n,a.points[0].price=r,e[e.length-1]=a}}))}},{key:"_twoPointGraphicMarkMouseMove",value:function(t,e,i){var a=this;this._graphicMarkMouseMove(t,e,(function(e,n){var r=a._xAxis.convertFromPixel(t.x),s=a._yAxis.convertFromPixel(t.y);switch(n.drawStep){case Kt:e.push({points:[{xPos:r,price:s},{xPos:r,price:s}],drawStep:Xt});break;case Xt:n.points[0]={xPos:r,price:s},n.points[1]={xPos:r,price:s},e[e.length-1]=n;break;case jt:n.points[1]={xPos:r,price:s},_(i)&&i(n,{xPos:r,price:s}),e[e.length-1]=n}}))}},{key:"_threePointGraphicMarkMouseMove",value:function(t,e,i){var a=this;this._graphicMarkMouseMove(t,e,(function(e,n){var r=a._xAxis.convertFromPixel(t.x),s=a._yAxis.convertFromPixel(t.y);switch(n.drawStep){case Kt:e.push({points:[{xPos:r,price:s},{xPos:r,price:s}],drawStep:Xt});break;case Xt:n.points[0]={xPos:r,price:s},n.points[1]={xPos:r,price:s},e[e.length-1]=n;break;case jt:_(i)&&i(n,{xPos:r,price:s}),n.points[1]={xPos:r,price:s},e[e.length-1]=n;break;case Ut:n.points[2]={xPos:r,price:s},e[e.length-1]=n}}))}},{key:"_graphicMarkMouseMove",value:function(t,e,i){var a=this._chartData.graphicMarkData(),n=a[e];i(n,n[n.length-1]||{drawStep:Kt}),a[e]=n,this._chartData.setGraphicMarkData(a)}},{key:"_checkEventPointY",value:function(t){var e=this._seriesSize.tags[ce];return t>e.contentTop&&e.contentBottom>t}}]),a}(Wt),Zt=function(t){function e(t,a,n,r){var s;return i(this,e),(s=c(this,o(e).call(this,t,a)))._xAxis=n,s._yAxis=r,s}return s(e,t),n(e,[{key:"_draw",value:function(){var t=this._chartData.styleOptions().graphicMark,e=this._chartData.precisionOptions().price;this._drawHorizontalStraightLine(t),this._drawVerticalStraightLine(t),this._drawStraightLine(t),this._drawHorizontalRayLine(t),this._drawVerticalRayLine(t),this._drawRayLine(t),this._drawSegmentLine(t),this._drawPriceLine(t,e),this._drawPriceChannelLine(t),this._drawParallelStraightLine(t),this._drawFibonacciLine(t,e)}},{key:"_drawHorizontalStraightLine",value:function(t){var e=this;this._drawPointGraphicMark(j,t,Ct,(function(t){return[[{x:0,y:t[0].y},{x:e._width,y:t[0].y}]]}))}},{key:"_drawVerticalStraightLine",value:function(t){var e=this;this._drawPointGraphicMark(U,t,Ct,(function(t){return[[{x:t[0].x,y:0},{x:t[0].x,y:e._height}]]}))}},{key:"_drawStraightLine",value:function(t){var e=this;this._drawPointGraphicMark(K,t,Ct,(function(t){if(t[0].x===t[1].x)return[[{x:t[0].x,y:0},{x:t[0].x,y:e._height}]];var i=Tt(t[0],t[1],[{x:0,y:t[0].y},{x:e._width,y:t[0].y}]);return[[{x:0,y:i[0]},{x:e._width,y:i[1]}]]}))}},{key:"_drawHorizontalRayLine",value:function(t){var e=this;this._drawPointGraphicMark(J,t,bt,(function(t){var i={x:0,y:t[0].y};return t[1].x>t[0].x&&(i.x=e._width),[[t[0],i]]}))}},{key:"_drawVerticalRayLine",value:function(t){var e=this;this._drawPointGraphicMark(Z,t,bt,(function(t){var i={x:t[0].x,y:0};return t[1].y>t[0].y&&(i.y=e._height),[[t[0],i]]}))}},{key:"_drawRayLine",value:function(t){var e=this;this._drawPointGraphicMark(q,t,bt,(function(t){var i;return i=t[0].x===t[1].x&&t[0].y!==t[1].y?t[1].y>t[0].y?{x:t[0].x,y:e._height}:{x:t[0].x,y:0}:t[0].x>t[1].x?{x:0,y:Tt(t[0],t[1],[{x:0,y:t[0].y}])[0]}:{x:e._width,y:Tt(t[0],t[1],[{x:e._width,y:t[0].y}])[0]},[[t[0],i]]}))}},{key:"_drawSegmentLine",value:function(t){this._drawPointGraphicMark($,t,Pt),this._drawPointGraphicMark(Q,t,Pt),this._drawPointGraphicMark(tt,t,Pt)}},{key:"_drawPriceLine",value:function(t,e){var i=this;this._drawPointGraphicMark(et,t,bt,(function(t){return[[t[0],{x:i._width,y:t[0].y}]]}),!0,e)}},{key:"_drawPriceChannelLine",value:function(t){var e=this;this._drawPointGraphicMark(it,t,Ct,(function(t){return At(t,{width:e._width,height:e._height},!0)}))}},{key:"_drawParallelStraightLine",value:function(t){var e=this;this._drawPointGraphicMark(at,t,Ct,(function(t){return At(t,{width:e._width,height:e._height})}))}},{key:"_drawFibonacciLine",value:function(t,e){var i=this;this._drawPointGraphicMark(nt,t,Ct,(function(t){return Lt(t,{width:i._width,height:i._height})}),!0,e,["(100.0%)","(78.6%)","(61.8%)","(50.0%)","(38.2%)","(23.6%)","(0.0%)"])}},{key:"_drawPointGraphicMark",value:function(t,e,i,a,n,r,s){var o=this;this._chartData.graphicMarkData()[t].forEach((function(t){var c=t.drawStep,h=[];t.points.forEach((function(t){var e=t.price,i=o._xAxis.convertToPixel(t.xPos),a=o._yAxis.convertToPixel(e);h.push({x:i,y:a})}));var l=a?a(h):[h];o._drawGraphicMark(e,l,h,c,i,n,r,s)}))}},{key:"_drawGraphicMark",value:function(t,e,i,a,n,r,s){var o=this,c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:[],h=this._chartData.graphicMarkPoint(),l=!1;e.forEach((function(e,i){if(e.length>1){var u=n(e[0],e[1],h);if(l||(l=u),a!==Xt){switch(o._ctx.strokeStyle=t.line.color,o._ctx.lineWidth=t.line.size,o._getLineType(e[0],e[1])){case 0:ut(o._ctx,(function(){o._ctx.beginPath(),o._ctx.moveTo(e[0].x,e[0].y),o._ctx.lineTo(e[1].x,e[1].y),o._ctx.stroke(),o._ctx.closePath()}));break;case 1:ht(o._ctx,e[0].y,e[0].x,e[1].x);break;case 2:lt(o._ctx,e[0].x,e[0].y,e[1].y)}if(r){var d=W(o._yAxis.convertFromPixel(e[0].y),s);o._ctx.font=ct(t.text.size,t.text.family),o._ctx.fillStyle=t.text.color,o._ctx.fillText("".concat(d," ").concat(c[i]||""),e[0].x+t.text.marginLeft,e[0].y-t.text.marginBottom)}}}}));for(var u=t.point.radius,d=!1,_=0;i.length>_&&!(d=Et(i[_],u,h));_++);i.forEach((function(e){var i=Et(e,u,h);if(d||l){var a=u,n=t.point.backgroundColor,r=t.point.borderColor,s=t.point.borderSize;i&&(a=t.point.activeRadius,n=t.point.activeBackgroundColor,r=t.point.activeBorderColor,s=t.point.activeBorderSize),o._ctx.fillStyle=n,o._ctx.beginPath(),o._ctx.arc(e.x,e.y,a,0,2*Math.PI),o._ctx.closePath(),o._ctx.fill(),o._ctx.lineWidth=s,o._ctx.strokeStyle=r,o._ctx.beginPath(),o._ctx.arc(e.x,e.y,a,0,2*Math.PI),o._ctx.closePath(),o._ctx.stroke()}}))}},{key:"_getLineType",value:function(t,e){return t.x===e.x?2:t.y===e.y?1:0}}]),e}(vt),qt=function(t){function e(){return i(this,e),c(this,o(e).apply(this,arguments))}return s(e,t),n(e,[{key:"_createMainView",value:function(t,e){return new Mt(t,e.chartData,e.xAxis,e.yAxis,e.additionalDataProvider)}},{key:"_createExpandView",value:function(t,e){return new Zt(t,e.chartData,e.xAxis,e.yAxis)}},{key:"_createFloatLayerView",value:function(t,e){return new Dt(t,e.chartData,e.xAxis,e.yAxis,e.additionalDataProvider)}},{key:"invalidate",value:function(t){1!==t&&h(o(e.prototype),"invalidate",this).call(this,t),this._expandView.flush()}},{key:"setSize",value:function(t,i){h(o(e.prototype),"setSize",this).call(this,t,i),this._expandView.setSize(t,i)}}]),e}(yt),$t=function(t){function e(t){var a;return i(this,e),(a=c(this,o(e).call(this,t)))._chartType=M,a}return s(e,t),n(e,[{key:"_createYAxis",value:function(t){return new wt(t.chartData,!0)}},{key:"_createMainWidget",value:function(t,e){return new qt({container:t,chartData:e.chartData,xAxis:e.xAxis,yAxis:this._yAxis,additionalDataProvider:{technicalIndicatorType:this.technicalIndicatorType.bind(this),chartType:this.chartType.bind(this),tag:this.tag.bind(this)}})}},{key:"_isRealTime",value:function(){return this._chartType===S}},{key:"chartType",value:function(){return this._chartType}},{key:"setChartType",value:function(t){this._chartType!==t&&(this._chartType=t,this._chartData.styleOptions().realTime.averageLine.display&&this._isRealTime()&&this._chartData.calcTechnicalIndicator(P.AVERAGE),this.invalidate(4))}}]),e}(St),Qt=function(t){function e(t,a,n){var r;return i(this,e),(r=c(this,o(e).call(this,t,a)))._xAxis=n,r}return s(e,t),n(e,[{key:"_draw",value:function(){var t=this._chartData.styleOptions().xAxis;t.display&&(this._drawAxisLine(t),this._drawTickLines(t),this._drawTickLabels(t))}},{key:"_drawAxisLine",value:function(t){var e=t.axisLine;e.display&&(this._ctx.strokeStyle=e.color,this._ctx.lineWidth=e.size,ht(this._ctx,0,0,this._width))}},{key:"_drawTickLines",value:function(t){var e=this,i=t.tickLine;if(i.display){this._ctx.lineWidth=i.size,this._ctx.strokeStyle=i.color;var a=t.axisLine.display?t.axisLine.size:0,n=a+i.length;this._xAxis.ticks().forEach((function(t){lt(e._ctx,t.x,a,n)}))}}},{key:"_drawTickLabels",value:function(t){var e=t.tickText;if(e.display){var i=t.tickLine;this._ctx.textBaseline="top",this._ctx.font=ct(e.size,e.family),this._ctx.textAlign="center",this._ctx.fillStyle=e.color;var a=e.margin;t.axisLine.display&&(a+=t.axisLine.size),i.display&&(a+=i.length);for(var n=this._xAxis.ticks(),r=n.length,s=0;r>s;s++)this._ctx.fillText(n[s].v,n[s].x,a)}}}]),e}(vt),te=function(t){function e(t,a,n){var r;return i(this,e),(r=c(this,o(e).call(this,t,a)))._xAxis=n,r}return s(e,t),n(e,[{key:"_draw",value:function(){this._drawCrossHairLabel()}},{key:"_drawCrossHairLabel",value:function(){if(this._chartData.crossHairSeriesTag()){var t=this._chartData.styleOptions().floatLayer.crossHair,e=t.vertical,i=e.text;if(t.display&&e.display&&i.display){var a,n=this._chartData.dataList(),r=this._chartData.crossHairPoint(),s=n[a=r?this._xAxis.convertFromPixel(r.x):n.length-1];if(s){var o=this._xAxis.convertToPixel(a),c=N(s.timestamp,"YYYY-MM-DD hh:mm",this._chartData.timezone()),h=i.size;this._ctx.font=ct(h,i.family);var l=ot(this._ctx,c),u=o-l/2,d=i.paddingLeft,_=i.paddingRight,v=i.paddingTop,f=i.borderSize;d+f>u?u=d+f:u>this._width-l-f-_&&(u=this._width-l-f-_);var p=u-f-d,y=u+l+f+_,m=0+h+2*f+v+i.paddingBottom;this._ctx.fillStyle=i.backgroundColor,this._ctx.fillRect(p,0,y-p,m-0),this._ctx.lineWidth=f,this._ctx.strokeStyle=i.borderColor,this._ctx.strokeRect(p,0,y-p,m-0),this._ctx.textBaseline="top",this._ctx.fillStyle=i.color,this._ctx.fillText(c,u,f+v)}}}}}]),e}(vt),ee=function(t){function e(){return i(this,e),c(this,o(e).apply(this,arguments))}return s(e,t),n(e,[{key:"_createMainView",value:function(t,e){return new Qt(t,e.chartData,e.xAxis)}},{key:"_createFloatLayerView",value:function(t,e){return new te(t,e.chartData,e.xAxis)}}]),e}(_t),ie=function(t){function e(t){var a;return i(this,e),(a=c(this,o(e).call(this,t)))._initMeasureCanvas(),a}return s(e,t),n(e,[{key:"_initMeasureCanvas",value:function(){var t=document.createElement("canvas");this._measureCtx=t.getContext("2d");var e=st(this._measureCtx);this._measureCtx.scale(e,e)}},{key:"_computeMinMaxValue",value:function(){var t=this._chartData.from(),e=this._chartData.to()-1;return{min:t,max:e,range:e-t}}},{key:"_computeOptimalTicks",value:function(t){var e=[],i=t.length,a=this._chartData.dataList();if(i>0){var n=this._chartData.timezone(),r=this._chartData.styleOptions().xAxis.tickText;this._measureCtx.font=ct(r.size,r.family);var s=ot(this._measureCtx,"00-00 00:00"),o=this.convertToPixel(parseInt(t[0].v,10)),c=1;if(i>1){var h=this.convertToPixel(parseInt(t[1].v,10)),l=Math.abs(h-o);s>l&&(c=Math.ceil(s/l))}for(var u=0;i>u;u+=c){var d=parseInt(t[u].v,10),_=a[d].timestamp,v=N(_,"hh:mm",n);i-1-c>=u&&(v=this._optimalTickLabel(_,a[parseInt(t[u+c].v,10)].timestamp,n)||v);var f=this.convertToPixel(d);e.push({v:v,x:f,oV:_})}var p=e.length;if(1===p)e[0].v=N(e[0].oV,"YYYY-MM-DD hh:mm",n);else{var y=e[p-1].v;e[p-1].v=this._optimalTickLabel(e[p-1].oV,e[p-2].oV,n)||y}}return e}},{key:"_optimalTickLabel",value:function(t,e,i){var a=N(t,"YYYY",i),n=N(t,"YYYY-MM",i),r=N(t,"MM-DD",i);return a!==N(e,"YYYY",i)?a:n!==N(e,"YYYY-MM",i)?n:r!==N(e,"MM-DD",i)?r:null}},{key:"convertFromPixel",value:function(t){return Math.round(this._chartData.coordinateToFloatIndex(t))-1}},{key:"convertToPixel",value:function(t){var e=this._chartData.dataList().length,i=this._chartData.dataSpace(),a=e+this._chartData.offsetRightBarCount()-t;return this._width-(a-.5)*i+this._chartData.barSpace()/2}}]),e}(kt),ae=function(t){function e(){return i(this,e),c(this,o(e).apply(this,arguments))}return s(e,t),n(e,[{key:"_initBefore",value:function(){this._xAxis=new ie(this._chartData)}},{key:"_createMainWidget",value:function(t,e){return new ee({container:t,chartData:e.chartData,xAxis:this._xAxis})}},{key:"_computeAxis",value:function(){this._xAxis.computeAxis()}},{key:"xAxis",value:function(){return this._xAxis}},{key:"setSize",value:function(t,i){this._xAxis.setSize(t.width,t.height),this._computeAxis(),h(o(e.prototype),"setSize",this).call(this,t,i)}}]),e}(dt),ne=function(){function t(e,a,n,r){i(this,t),this._chartData=a,this._seriesIndex=n,this._width=0,this._offsetLeft=0,this._dragEventHandler=r,this._initElement(e)}return n(t,[{key:"_initElement",value:function(t){this._container=t,this._wrapper=document.createElement("div"),this._wrapper.style.margin="0",this._wrapper.style.padding="0",this._wrapper.style.overflow="hidden",this._element=document.createElement("div"),this._element.style.margin="0",this._element.style.padding="0",this._element.style.width="100%",this._element.style.cursor="ns-resize",this._element.style.position="absolute",this._element.style.zIndex="20",this._element.style.height="5px",this._wrapper.appendChild(this._element);var e=t.lastChild;e?t.insertBefore(this._wrapper,e):t.appendChild(this._wrapper),this._dragEvent=new Ft(this._element,{mouseDownEvent:this._mouseDownEvent.bind(this),pressedMouseMoveEvent:this._pressedMouseMoveEvent.bind(this)},{treatVertTouchDragAsPageScroll:!1,treatHorzTouchDragAsPageScroll:!0})}},{key:"_mouseDownEvent",value:function(t){this._startY=t.pageY,this._dragEventHandler.startDrag(this._seriesIndex)}},{key:"_pressedMouseMoveEvent",value:function(t){this._dragEventHandler.drag(t.pageY-this._startY,this._seriesIndex)}},{key:"height",value:function(){return this._wrapper.offsetHeight}},{key:"setSize",value:function(t,e){this._offsetLeft=t,this._width=e,this.invalidate()}},{key:"updateSeriesIndex",value:function(t){this._seriesIndex=t}},{key:"invalidate",value:function(){var t=this._chartData.styleOptions().separator;this._wrapper.style.backgroundColor=t.color,this._wrapper.style.height="".concat(t.size,"px"),this._wrapper.style.marginLeft="".concat(t.fill?0:this._offsetLeft,"px"),this._wrapper.style.width=t.fill?"100%":"".concat(this._width,"px")}},{key:"getImage",value:function(){var t=this._chartData.styleOptions().separator,e=document.createElement("canvas"),i=e.getContext("2d"),a=st(i),n=this._wrapper.offsetWidth,r=t.size;return e.style.width="".concat(n,"px"),e.style.height="".concat(r,"px"),e.width=n*a,e.height=r*a,i.scale(a,a),i.fillStyle=t.color,i.fillRect(this._offsetLeft,0,n,r),e}},{key:"destroy",value:function(){this._dragEvent.destroy(),this._container.removeChild(this._wrapper)}}]),t}(),re=function(t){function e(t){var a;return i(this,e),(a=c(this,o(e).call(this,t)))._startScrollPoint={},a._touchPoint={},a._touchCancelCrossHair=!1,a._touchZoomed=!1,a._pinchScale=1,a}return s(e,t),n(e,[{key:"pinchStartEvent",value:function(){this._pinchScale=1,this._touchZoomed=!0}},{key:"pinchEvent",value:function(t,e){var i=5*(e-this._pinchScale);this._pinchScale=e,this._chartData.zoom(i,t)}},{key:"mouseLeaveEvent",value:function(t){Nt(t)&&this._chartData.setCrossHairSeriesTag(null)}},{key:"mouseMoveEvent",value:function(t){if(Nt(t))if(this._checkEventPointX(t.localX)){var e=this._translateCrossHairRealY(t.localY);e?(this._chartData.setCrossHairPoint({x:t.localX,y:e.y}),this._chartData.setCrossHairSeriesTag(e.tag)):this._chartData.setCrossHairSeriesTag(null)}else this._chartData.setCrossHairSeriesTag(null)}},{key:"mouseWheelEvent",value:function(t){if(this._checkEventPointX(t.localX)){var e=-t.deltaY/100;if(0!==e){switch(t.cancelable&&t.preventDefault(),t.deltaMode){case t.DOM_DELTA_PAGE:e*=120;break;case t.DOM_DELTA_LINE:e*=32}if(0!==e){var i=Math.sign(e)*Math.min(1,Math.abs(e));this._chartData.zoom(i,{x:t.localX,y:t.localY})}}}}},{key:"mouseClickEvent",value:function(t){if(Gt(t)&&this._checkEventPointX(t.localX)){var e=this._translateCrossHairRealY(t.localY);e&&(this._touchPoint||this._touchCancelCrossHair||this._touchZoomed||(this._touchPoint={x:t.localX,y:t.localY},this._chartData.setCrossHairPoint({x:t.localX,y:e.y}),this._chartData.setCrossHairSeriesTag(e.tag)))}}},{key:"mouseDownEvent",value:function(t){if(this._startScrollPoint={x:t.localX,y:t.localY},this._chartData.startScroll(),Gt(t)&&this._checkEventPointX(t.localX)){var e=this._translateCrossHairRealY(t.localY);if(e){var i={x:t.localX,y:e.y};if(this._touchZoomed=!1,this._touchPoint){var a=t.localX-this._touchPoint.x,n=t.localY-this._touchPoint.y;10>Math.sqrt(a*a+n*n)?(this._touchPoint={x:t.localX,y:t.localY},this._chartData.setCrossHairPoint(i),this._chartData.setCrossHairSeriesTag(e.tag)):(this._touchCancelCrossHair=!0,this._touchPoint=null,this._chartData.setCrossHairPoint(i),this._chartData.setCrossHairSeriesTag(null))}else this._touchCancelCrossHair=!1}}}},{key:"pressedMouseMoveEvent",value:function(t){if(this._checkEventPointX(t.localX)){var e=this._translateCrossHairRealY(t.localY);if(e){var i={x:t.localX,y:e.y};if(Gt(t)&&this._touchPoint)return this._touchPoint={x:t.localX,y:t.localY},this._chartData.setCrossHairPoint(i),void this._chartData.setCrossHairSeriesTag(e.tag);var a=t.localX-this._startScrollPoint.x;this._chartData.setCrossHairPoint(i),this._chartData.scroll(a)}}}},{key:"longTapEvent",value:function(t){if(Gt(t)&&this._checkEventPointX(t.localX)){var e=this._translateCrossHairRealY(t.localY);e&&(this._touchPoint={x:t.localX,y:t.localY},this._chartData.setCrossHairPoint({x:t.localX,y:e.y}),this._chartData.setCrossHairSeriesTag(e.tag))}}},{key:"_translateCrossHairRealY",value:function(t){var e=this._seriesSize.tags||{};for(var i in e){var a=e[i];if(t>a.contentTop&&a.contentBottom>t)return{tag:i,y:t-a.contentTop}}return null}}]),e}(Wt),se=function(t){function e(){return i(this,e),c(this,o(e).apply(this,arguments))}return s(e,t),n(e,[{key:"keyBoardDownEvent",value:function(t){if(t.shiftKey)switch(t.code){case"ArrowUp":this._chartData.zoom(-.05,this._chartData.crossHairPoint());break;case"ArrowDown":this._chartData.zoom(.05,this._chartData.crossHairPoint());break;case"ArrowLeft":this._chartData.startScroll(),this._chartData.scroll(-this._chartData.dataSpace());break;case"ArrowRight":this._chartData.startScroll(),this._chartData.scroll(this._chartData.dataSpace())}}}]),e}(Wt),oe=function(){function t(e,a,n,r){i(this,t),this._target=e,this._chartData=a,this._seriesSize={},this._event=new Ft(this._target,{pinchStartEvent:this._pinchStartEvent.bind(this),pinchEvent:this._pinchEvent.bind(this),mouseUpEvent:this._mouseUpEvent.bind(this),mouseClickEvent:this._mouseClickEvent.bind(this),mouseDownEvent:this._mouseDownEvent.bind(this),mouseRightDownEvent:this._mouseRightDownEvent.bind(this),mouseLeaveEvent:this._mouseLeaveEvent.bind(this),mouseMoveEvent:this._mouseMoveEvent.bind(this),mouseWheelEvent:this._mouseWheelEvent.bind(this),pressedMouseMoveEvent:this._pressedMouseMoveEvent.bind(this),longTapEvent:this._longTapEvent.bind(this)},{treatVertTouchDragAsPageScroll:!1,treatHorzTouchDragAsPageScroll:!1}),this._boundKeyBoardDownEvent=this._keyBoardDownEvent.bind(this),this._target.addEventListener("keydown",this._boundKeyBoardDownEvent),this._boundContextMenuEvent=function(t){t.preventDefault()},this._target.addEventListener("contextmenu",this._boundContextMenuEvent,!1),this._zoomScrollEventHandler=new re(a),this._graphicMarkEventHandler=new Jt(a,n,r),this._keyBoardEventHandler=new se(a)}return n(t,[{key:"_keyBoardDownEvent",value:function(t){this._keyBoardEventHandler.keyBoardDownEvent(t)}},{key:"_pinchStartEvent",value:function(){this._zoomScrollEventHandler.pinchStartEvent()}},{key:"_pinchEvent",value:function(t,e){this._zoomScrollEventHandler.pinchEvent(t,e)}},{key:"_mouseUpEvent",value:function(t){this._target.style.cursor="crosshair",t.localX-=this._seriesSize.contentLeft,this._graphicMarkEventHandler.mouseUpEvent(t)}},{key:"_mouseLeaveEvent",value:function(t){this._checkZoomScroll()&&(t.localX-=this._seriesSize.contentLeft,this._zoomScrollEventHandler.mouseLeaveEvent(t))}},{key:"_mouseMoveEvent",value:function(t){t.localX-=this._seriesSize.contentLeft,this._chartData.shouldInvalidateGraphicMark()&&this._graphicMarkEventHandler.mouseMoveEvent(t),this._checkZoomScroll()&&this._zoomScrollEventHandler.mouseMoveEvent(t)}},{key:"_mouseWheelEvent",value:function(t){this._checkZoomScroll()&&this._zoomScrollEventHandler.mouseWheelEvent(t)}},{key:"_mouseClickEvent",value:function(t){this._checkZoomScroll()&&(t.localX-=this._seriesSize.contentLeft,this._zoomScrollEventHandler.mouseClickEvent(t))}},{key:"_mouseDownEvent",value:function(t){this._target.style.cursor="pointer",t.localX-=this._seriesSize.contentLeft,this._graphicMarkEventHandler.mouseDownEvent(t),this._checkZoomScroll()&&this._zoomScrollEventHandler.mouseDownEvent(t)}},{key:"_mouseRightDownEvent",value:function(t){t.localX-=this._seriesSize.contentLeft,this._graphicMarkEventHandler.mouseRightDownEvent(t)}},{key:"_pressedMouseMoveEvent",value:function(t){t.localX-=this._seriesSize.contentLeft,this._chartData.dragGraphicMarkFlag()&&(this._graphicMarkEventHandler.pressedMouseMoveEvent(t),null!==this._chartData.crossHairSeriesTag()&&this._chartData.setCrossHairSeriesTag(null)),this._checkZoomScroll()&&this._zoomScrollEventHandler.pressedMouseMoveEvent(t)}},{key:"_longTapEvent",value:function(t){this._checkZoomScroll()&&(t.localX-=this._seriesSize.contentLeft,this._zoomScrollEventHandler.longTapEvent(t))}},{key:"_checkZoomScroll",value:function(){return!this._chartData.dragGraphicMarkFlag()&&this._chartData.graphicMarkType()===X}},{key:"setSeriesSize",value:function(t){this._seriesSize=t,this._zoomScrollEventHandler.setSeriesSize(t),this._graphicMarkEventHandler.setSeriesSize(t)}},{key:"destroy",value:function(){this._event.destroy(),this._target.removeEventListener("keydown",this._boundKeyBoardDownEvent),this._target.removeEventListener("contextmenu",this._boundContextMenuEvent)}}]),t}(),ce="candle_stick_series_tag",he=function(){function t(e,a){i(this,t),this._initChartContainer(e),this._technicalIndicatorBaseId=0,this._technicalIndicatorSeries=[],this._separatorSeries=[],this._separatorDragStartTechnicalIndicatorHeight=0,this._chartData=new rt(a,this._updateSeries.bind(this)),this._xAxisSeries=new ae({container:this._chartContainer,chartData:this._chartData}),this._candleStickSeries=new $t({container:this._chartContainer,chartData:this._chartData,xAxis:this._xAxisSeries.xAxis(),technicalIndicatorType:P.MA,tag:ce}),this._chartEvent=new oe(this._chartContainer,this._chartData,this._xAxisSeries.xAxis(),this._candleStickSeries.yAxis()),this.measureSeriesSize()}return n(t,[{key:"_initChartContainer",value:function(t){this._container=t,this._chartContainer=document.createElement("div"),this._chartContainer.style.position="relative",this._chartContainer.style.outline="none",this._chartContainer.style.borderStyle="none",this._chartContainer.style.width="100%",this._chartContainer.style.cursor="crosshair",this._chartContainer.tabIndex=1,t.appendChild(this._chartContainer)}},{key:"_separatorStartDrag",value:function(t){this._separatorDragStartTechnicalIndicatorHeight=this._technicalIndicatorSeries[t].height()}},{key:"_separatorDrag",value:function(t,e){this._technicalIndicatorSeries[e].setTempHeight(this._separatorDragStartTechnicalIndicatorHeight-t),this.measureSeriesSize()}},{key:"_measureXAxisHeight",value:function(){var t=this._chartData.styleOptions().xAxis,e=t.axisLine,i=t.tickText,a=t.tickLine,n=0;return t.display&&(e.display&&(n+=e.size),a.display&&(n+=a.length),i.display&&(n+=i.size+i.margin)),n>0&&(n=Math.ceil(Math.max(t.minHeight,Math.min(n,t.maxHeight)))),n}},{key:"_measureYAxisWidth",value:function(){var t=this._chartData.styleOptions().yAxis,e=t.tickText,i=0;return t.display&&(t.axisLine.display&&(i+=t.axisLine.size),t.tickLine.display&&(i+=t.tickLine.length),t.tickText.display&&(i+=e.margin+6*(e.size-2))),i>0&&(i=Math.ceil(Math.max(t.minWidth,Math.min(i,t.maxWidth)))),i}},{key:"_measureSeparatorHeight",value:function(){return this._chartData.styleOptions().separator.size*this._separatorSeries.length}},{key:"_updateSeries",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:4;if(1!==t){this._xAxisSeries.invalidate(t);var e=!0,i=!1,a=void 0;try{for(var n,r=this._technicalIndicatorSeries[Symbol.iterator]();!(e=(n=r.next()).done);e=!0){var s=n.value;s.invalidate(t)}}catch(t){i=!0,a=t}finally{try{e||null==r.return||r.return()}finally{if(i)throw a}}}this._candleStickSeries.invalidate(t)}},{key:"_calcAllSeriesTechnicalIndicator",value:function(){var t=[];this._candleStickSeries.chartType()===M?t.push(this._candleStickSeries.technicalIndicatorType()):this._chartData.calcTechnicalIndicator(P.AVERAGE);var e=!0,i=!1,a=void 0;try{for(var n,r=this._technicalIndicatorSeries[Symbol.iterator]();!(e=(n=r.next()).done);e=!0){var s=n.value.technicalIndicatorType();0>t.indexOf(s)&&t.push(s)}}catch(t){i=!0,a=t}finally{try{e||null==r.return||r.return()}finally{if(i)throw a}}for(var o=0,c=t;c.length>o;o++)this._chartData.calcTechnicalIndicator(c[o]);this._updateSeries()}},{key:"chartData",value:function(){return this._chartData}},{key:"measureSeriesSize",value:function(){var t=this._chartData.styleOptions().yAxis,e=t.position===x,i=t.tickText.position===w,a=this._container.offsetWidth,n=this._container.offsetHeight,r=this._measureSeparatorHeight(),s=this._measureXAxisHeight(),o=this._measureYAxisWidth(),c=n-s-r,h=a-(i?o:0),l=a-o,u=0;e&&(l=0,i&&(u=o));var d=0,_=!0,v=!1,f=void 0;try{for(var p,y=this._technicalIndicatorSeries[Symbol.iterator]();!(_=(p=y.next()).done);_=!0)d+=p.value.height()}catch(t){v=!0,f=t}finally{try{_||null==y.return||y.return()}finally{if(v)throw f}}var m=c-d;this._chartData.setTotalDataSpace(h);var g={};g.contentLeft=u,g.contentRight=u+h;var k={};k[ce]={contentTop:0,contentBottom:m};var S=m,M=m;this._candleStickSeries.setSize({left:u,width:h,height:m},{left:l,width:o,height:m});for(var D=0;this._technicalIndicatorSeries.length>D;D++){var T=this._technicalIndicatorSeries[D],C=this._separatorSeries[D],b=T.height();T.setSize({left:u,width:h,height:b},{left:l,width:o,height:b}),C.setSize(u,h),M+=b,k[T.tag()]={contentTop:S,contentBottom:M},S=M}g.tags=k,this._xAxisSeries.setSize({left:u,width:h,height:s},{left:l,width:o,height:s}),this._chartEvent.setSeriesSize(g)}},{key:"applyTechnicalIndicatorParams",value:function(t,e){if(this._chartData.applyTechnicalIndicatorParams(t,e),this._chartData.calcTechnicalIndicator(t)){this._candleStickSeries.technicalIndicatorType()===t&&this._candleStickSeries.invalidate(4);var i=!0,a=!1,n=void 0;try{for(var r,s=this._technicalIndicatorSeries[Symbol.iterator]();!(i=(r=s.next()).done);i=!0){var o=r.value;o.technicalIndicatorType()===t&&o.invalidate(4)}}catch(t){a=!0,n=t}finally{try{i||null==s.return||s.return()}finally{if(a)throw n}}}}},{key:"_applyDataList",value:function(t,e,i){if(d(t)){_(i)&&i();var a=this._chartData.addData(t,0,e);0!==a&&this._calcAllSeriesTechnicalIndicator(a)}}},{key:"applyNewData",value:function(t,e){var i=this;this._applyDataList(t,e,(function(){i._chartData.clearDataList()}))}},{key:"applyMoreData",value:function(t,e){this._applyDataList(t,e)}},{key:"updateData",value:function(t){if(v(t)&&!d(t)){var e=this._chartData.dataList(),i=e.length,a=i;+F(t,"timestamp",0)===+F(e[i-1],"timestamp",0)&&(a=i-1),this._chartData.addData(t,a),this._calcAllSeriesTechnicalIndicator()}}},{key:"setCandleStickSeriesType",value:function(t){this._candleStickSeries.setChartType(t)}},{key:"createTechnicalIndicator",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100;t&&P.hasOwnProperty(t)&&t!==P.NO&&t!==P.AVERAGE||(t=P.MACD);var i=this._technicalIndicatorSeries.length;this._separatorSeries.push(new ne(this._chartContainer,this._chartData,i,{startDrag:this._separatorStartDrag.bind(this),drag:this._separatorDrag.bind(this)})),this._technicalIndicatorBaseId++;var a="".concat("technical_indicator_").concat(this._technicalIndicatorBaseId),n=new St({container:this._chartContainer,chartData:this._chartData,xAxis:this._xAxisSeries.xAxis(),technicalIndicatorType:t,tag:a});return n.setTempHeight(e),this._technicalIndicatorSeries.push(n),this.measureSeriesSize(),a}},{key:"removeTechnicalIndicator",value:function(t){for(var e=-1,i=0;this._technicalIndicatorSeries.length>i;i++)if(this._technicalIndicatorSeries[i].tag()===t){e=i;break}if(-1!==e){this._technicalIndicatorSeries[e].destroy(),this._separatorSeries[e].destroy(),this._technicalIndicatorSeries.splice(e,1),this._separatorSeries.splice(e,1);for(var a=0;this._separatorSeries.length>a;a++)this._separatorSeries[a].updateSeriesIndex(a);this.measureSeriesSize()}}},{key:"setTechnicalIndicatorType",value:function(t,e){if(t===ce)this._candleStickSeries.setTechnicalIndicatorType(e);else{var i,a=!0,n=!1,r=void 0;try{for(var s,o=this._technicalIndicatorSeries[Symbol.iterator]();!(a=(s=o.next()).done);a=!0){var c=s.value;if(c.tag()===t){i=c;break}}}catch(t){n=!0,r=t}finally{try{a||null==o.return||o.return()}finally{if(n)throw r}}i&&(e===P.NO?this.removeTechnicalIndicator(t):i.setTechnicalIndicatorType(e))}}},{key:"setTimezone",value:function(t){this._chartData.setTimezone(t),this._xAxisSeries.invalidate(4)}},{key:"getConvertPictureUrl",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"jpeg";if("png"!==i&&"jpeg"!==i&&"bmp"!==i)throw Error("Picture format only supports jpeg, png and bmp!!!");var a=document.createElement("canvas"),n=a.getContext("2d"),r=st(n),s=this._chartContainer.offsetWidth,o=this._chartContainer.offsetHeight;a.style.width="".concat(s,"px"),a.style.height="".concat(o,"px"),a.width=s*r,a.height=o*r,n.scale(r,r);var c=0,h=this._candleStickSeries.height();n.drawImage(this._candleStickSeries.getImage(t,e),0,c,s,h),n.drawImage(this._candleStickSeries.getImage(t,e),0,c,s,h),c+=h;for(var l=0;this._separatorSeries.length>l;l++){var u=this._separatorSeries[l],d=u.height(),_=this._technicalIndicatorSeries[l],v=_.height();n.drawImage(u.getImage(),0,c,s,d),c+=d,n.drawImage(_.getImage(t),0,c,s,v),c+=v}return n.drawImage(this._xAxisSeries.getImage(t),0,c,s,this._xAxisSeries.height()),a.toDataURL("image/".concat(i))}},{key:"destroy",value:function(){this._candleStickSeries.destroy(),this._technicalIndicatorSeries.forEach((function(t){t.destroy()})),this._separatorSeries.forEach((function(t){t.destroy()})),this._xAxisSeries.destroy(),this._container.removeChild(this._chartContainer),this._chartEvent.destroy()}}]),t}(),le=function(){function t(e,a){i(this,t),this._chartSeries=new he(e,a)}return n(t,[{key:"setStyleOptions",value:function(t){this._chartSeries.chartData().applyStyleOptions(t),this._chartSeries.measureSeriesSize()}},{key:"getStyleOptions",value:function(){return u(this._chartSeries.chartData().styleOptions())}},{key:"setTechnicalIndicatorParams",value:function(t,e){this._chartSeries.applyTechnicalIndicatorParams(t,e)}},{key:"getTechnicalIndicatorParamOptions",value:function(){return u(this._chartSeries.chartData().technicalIndicatorParamOptions())}},{key:"setPrecision",value:function(t,e){this._chartSeries.chartData().applyPrecision(t,e)}},{key:"setTimezone",value:function(t){this._chartSeries.setTimezone(t)}},{key:"resize",value:function(){this._chartSeries.measureSeriesSize()}},{key:"setOffsetRightSpace",value:function(t){this._chartSeries.chartData().setOffsetRightSpace(t)}},{key:"setLeftMinVisibleBarCount",value:function(t){this._chartSeries.chartData().setLeftMinVisibleBarCount(t)}},{key:"setRightMinVisibleBarCount",value:function(t){this._chartSeries.chartData().setRightMinVisibleBarCount(t)}},{key:"setDataSpace",value:function(t){this._chartSeries.chartData().setDataSpace(t)}},{key:"clearData",value:function(){this._chartSeries.chartData().clearDataList()}},{key:"getDataList",value:function(){return this._chartSeries.chartData().dataList()}},{key:"applyNewData",value:function(t,e){this._chartSeries.applyNewData(t,e)}},{key:"applyMoreData",value:function(t,e){this._chartSeries.applyMoreData(t,e)}},{key:"updateData",value:function(t){this._chartSeries.updateData(t)}},{key:"loadMore",value:function(t){this._chartSeries.chartData().loadMore(t)}},{key:"setCandleStickChartType",value:function(t){this._chartSeries.setCandleStickSeriesType(t)}},{key:"setCandleStickTechnicalIndicatorType",value:function(t){this._chartSeries.setTechnicalIndicatorType(ce,t)}},{key:"setTechnicalIndicatorType",value:function(t,e){this._chartSeries.setTechnicalIndicatorType(t,e)}},{key:"addTechnicalIndicator",value:function(t,e){return this._chartSeries.createTechnicalIndicator(t,e)}},{key:"removeTechnicalIndicator",value:function(t){this._chartSeries.removeTechnicalIndicator(t)}},{key:"addGraphicMark",value:function(t){var e=this._chartSeries.chartData().graphicMarkType();if(e!==t){var i=this._chartSeries.chartData().graphicMarkData(),a=i[e];a&&d(a)&&(a.splice(a.length-1,1),i[e]=a),i.hasOwnProperty(t)||(t=X),this._chartSeries.chartData().setGraphicMarkType(t),this._chartSeries.chartData().setGraphicMarkData(i)}}},{key:"removeAllGraphicMark",value:function(){var t=this._chartSeries.chartData().graphicMarkData(),e={};Object.keys(t).forEach((function(t){e[t]=[]})),this._chartSeries.chartData().setGraphicMarkType(X),this._chartSeries.chartData().setGraphicMarkData(e)}},{key:"getConvertPictureUrl",value:function(t,e,i){return this._chartSeries.getConvertPictureUrl(t,e,i)}},{key:"destroy",value:function(){this._chartSeries.destroy()}}]),t}(),ue={},de=1,_e="Chart version is 5.2.0. Root dom is null, can not initialize the chart!!!";t.dispose=function(t){var e;t&&("string"==typeof t&&(e=(t=document.getElementById(t)||document.getElementsByClassName(t)).chart_id),e||(e=t.chart_id),!e&&t instanceof le&&(e=t.id),e&&(ue[e].destroy(),delete ue[e]))},t.init=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=t;if(!i)throw Error(_e);if("string"==typeof i&&(i=document.getElementById(t)||document.getElementsByClassName(t)),!i)throw Error(_e);var a=ue[i.chart_id||""];if(a)return a;var n="k_line_chart_".concat(de++),r=new le(i,e);return r.id=n,i.chart_id=n,ue[n]=r,r},t.version=function(){return"5.2.0"},Object.defineProperty(t,"__esModule",{value:!0})}(e)},function(t,e,i){},function(t,e,i){},function(t,e,i){},function(t,e,i){},function(t,e,i){},function(t,e,i){"use strict";i.r(e);var a=i(0),n=i.n(a),r=i(9),s=i.n(r),o=i(6),c=i(2),h=i(3),l=i(5),u=i(4),d=i(1),_=i.n(d),v=i(7),f={"zh-CN":i(10),en:i(11)},p="zh-CN";function y(t){return(f[p]||f["zh-CN"])[t]||"--"}i(19);var m=[{key:"Etc/UTC",text:"utc",utc:""},{key:"Pacific/Honolulu",text:"honolulu",utc:"(UTC-10)"},{key:"America/Juneau",text:"juneau",utc:"(UTC-8)"},{key:"America/Los_Angeles",text:"los_angeles",utc:"(UTC-7)"},{key:"America/Chicago",text:"chicago",utc:"(UTC-5)"},{key:"America/Toronto",text:"toronto",utc:"(UTC-4)"},{key:"America/Sao_Paulo",text:"sao_paulo",utc:"(UTC-3)"},{key:"Europe/London",text:"london",utc:"(UTC+1)"},{key:"Europe/Berlin",text:"berlin",utc:"(UTC+2)"},{key:"Asia/Bahrain",text:"bahrain",utc:"(UTC+3)"},{key:"Asia/Dubai",text:"dubai",utc:"(UTC+4)"},{key:"Asia/Ashkhabad",text:"ashkhabad",utc:"(UTC+5)"},{key:"Asia/Almaty",text:"almaty",utc:"(UTC+6)"},{key:"Asia/Bangkok",text:"bangkok",utc:"(UTC+7)"},{key:"Asia/Shanghai",text:"shanghai",utc:"(UTC+8)"},{key:"Asia/Tokyo",text:"tokyo",utc:"(UTC+9)"},{key:"Australia/Sydney",text:"sydney",utc:"(UTC+10)"},{key:"Pacific/Norfolk",text:"norfolk",utc:"(UTC+12)"}],x=function(t){Object(l.a)(i,t);var e=Object(u.a)(i);function i(){return Object(c.a)(this,i),e.apply(this,arguments)}return Object(h.a)(i,[{key:"render",value:function(){var t=this,e=this.props,i=e.timezone,a=e.theme;return n.a.createElement("div",{className:"timezone-".concat(a)},n.a.createElement("div",{className:"timezone-content"},n.a.createElement("span",{className:"timezone-content-title"},y("timezone")),n.a.createElement("div",{className:"timezone-content-select"},n.a.createElement("span",null,i.utc,"\xa0",y(i.text)),n.a.createElement("i",{className:"timezone-content-select-arrow"}),n.a.createElement("ul",{className:"timezone-content-select-drop-down-container"},m.map((function(e){return n.a.createElement("li",{key:e.key,onClick:function(){t.props.onTimezoneChange(e)}},e.utc,"\xa0",y(e.text))}))))))}}]),i}(a.PureComponent);x.defaultProps={theme:"dark",timezone:{},onTimezoneChange:function(){}};i(20);var g={MA:4,EMA:3,VOL:3,MACD:3,BOLL:1,KDJ:3,RSI:3,BIAS:3,BRAR:1,CCI:1,DMI:2,CR:5,PSY:1,DMA:3,TRIX:2,OBV:1,VR:2,WR:3,MTM:2,EMV:2,SAR:3},k=function(t){Object(l.a)(i,t);var e=Object(u.a)(i);function i(){return Object(c.a)(this,i),e.apply(this,arguments)}return Object(h.a)(i,[{key:"renderRows",value:function(t){var e=this.props,i=e.technicalIndicatorParams,a=e.onParamChange;return t.map((function(t){for(var e=g[t],r=[],s=i[t]||[],o=function(e){r.push(n.a.createElement("input",{key:"input_".concat(e),className:"technical-indicator-params-column-row-input",value:s[e]||"",onChange:function(i){var n=i.target.value;/^[1-9]*$/.test(n)&&a(t,e,n)}}))},c=0;c<e;c++)o(c);return n.a.createElement("li",{key:t},n.a.createElement("span",{className:"technical-indicator-params-column-row-title"},t),r)}))}},{key:"render",value:function(){return n.a.createElement("div",{className:"technical-indicator-params-".concat(this.props.theme)},n.a.createElement("ul",{className:"technical-indicator-params-column"},this.renderRows(["MA","EMA","VOL","MACD","BOLL","KDJ","RSI","BIAS","BRAR","CCI","DMI"])),n.a.createElement("ul",{className:"technical-indicator-params-column"},this.renderRows(["CR","PSY","DMA","TRIX","OBV","VR","WR","MTM","EMV","SAR"])))}}]),i}(a.PureComponent);k.defaultProps={theme:"dark",technicalIndicatorParams:{},onParamChange:function(){}};i(21);var w=[{key:"timezone",text:"timezone"},{key:"technical_indicator_params",text:"technical_indicator_params"}],S=function(t){Object(l.a)(i,t);var e=Object(u.a)(i);function i(){var t;Object(c.a)(this,i);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(t=e.call.apply(e,[this].concat(r))).state={currentTab:"timezone"},t.rootEl=Object(a.createRef)(),t}return Object(h.a)(i,[{key:"componentDidMount",value:function(){var t=this;setTimeout((function(){t.rootEl.current.className="setting-modal-".concat(t.props.theme," setting-modal-show")}))}},{key:"render",value:function(){var t=this,e=this.state.currentTab,i=this.props,a=i.theme,r=i.timezone,s=i.technicalIndicatorParams,o=i.onClose,c=i.onConfirm,h=i.onTimezoneChange,l=i.onParamChange;return n.a.createElement("div",{ref:this.rootEl,className:"setting-modal-".concat(a)},n.a.createElement("div",{className:"setting-modal-title-container"},n.a.createElement("div",{className:"setting-modal-title-tab-container"},w.map((function(i){return n.a.createElement("span",{key:i.key,className:"setting-modal-title-tab ".concat(e===i.key&&"setting-modal-title-tab-selected"),onClick:function(){t.setState({currentTab:i.key})}},y(i.text))}))),n.a.createElement("i",{className:"icon-close setting-modal-title-icon",onClick:o})),n.a.createElement("div",{className:"setting-modal-content-container"},"timezone"===e&&n.a.createElement(x,{theme:a,timezone:r,onTimezoneChange:h}),"technical_indicator_params"===e&&n.a.createElement(k,{theme:a,technicalIndicatorParams:s,onParamChange:l})),n.a.createElement("div",{className:"setting-modal-bottom-container"},n.a.createElement("button",{datatype:"cancel",onClick:o},y("cancel")),n.a.createElement("button",{datatype:"confirm",onClick:c},y("confirm"))))}}]),i}(a.PureComponent);S.defaultProps={theme:"dark",timezone:{},technicalIndicatorParams:{},onTimezoneChange:function(){},onClose:function(){},onConfirm:function(){},onParamChange:function(){}};i(22);var M=["Line","1m","5m","15m","30m","1H","2H","4H","6H","12H","1D","1W","1M","1Y"],D=[{key:"horizontalStraightLine",icon:"icon-horizontal-straight-line"},{key:"horizontalRayLine",icon:"icon-horizontal-ray-line"},{key:"horizontalSegmentLine",icon:"icon-horizontal-segment-line"},{key:"priceLine",icon:"icon-price-line"},{key:"verticalStraightLine",icon:"icon-vertical-straight-line"},{key:"verticalRayLine",icon:"icon-vertical-ray-line"},{key:"verticalSegmentLine",icon:"icon-vertical-segment-line"},{key:"straightLine",icon:"icon-straight-line"},{key:"rayLine",icon:"icon-ray-line"},{key:"segmentLine",icon:"icon-segment-line"},{key:"parallelStraightLine",icon:"icon-parallel-straight-line"},{key:"priceChannelLine",icon:"icon-price-channel-line"},{key:"fibonacciLine",icon:"icon-fibonacci-line"}],T=[{key:"solid",text:"all_solid",icon:"icon-candle-stick-solid"},{key:"stroke",text:"all_stroke",icon:"icon-candle-stick-stroke"},{key:"up_stroke",text:"up_stroke",icon:"icon-candle-stick-up-stroke"},{key:"down_stroke",text:"down_stroke",icon:"icon-candle-stick-down-stroke"},{key:"ohlc",text:"ohlc",icon:"icon-candle-stick-ohlc"}],C=["MA","EMA","VOL","MACD","BOLL","KDJ","RSI","BIAS","BRAR","CCI","DMI","CR","PSY","DMA","TRIX","OBV","VR","WR","MTM","EMV","SAR"];function b(t,e){if(e)switch(t){case"Line":case"1m":return _()(e).subtract(1,"minutes").valueOf();case"5m":return _()(e).subtract(5,"minutes").valueOf();case"15m":return _()(e).subtract(15,"minutes").valueOf();case"30m":return _()(e).subtract(30,"minutes").valueOf();case"1H":return _()(e).subtract(1,"hours").valueOf();case"2H":return _()(e).subtract(2,"hours").valueOf();case"4H":return _()(e).subtract(4,"hours").valueOf();case"6H":return _()(e).subtract(6,"hours").valueOf();case"12H":return _()(e).subtract(12,"hours").valueOf();case"1D":return _()(e).subtract(1,"days").valueOf();case"1W":return _()(e).subtract(1,"weeks").valueOf();case"1M":return _()(e).subtract(1,"months").valueOf();case"1Y":return _()(e).subtract(1,"years").valueOf()}else{var i=_()();switch(t){case"Line":case"1m":return i.startOf("minute").valueOf();case"5m":var a=i.valueOf()%3e5;return i.valueOf()-a;case"15m":var n=i.valueOf()%9e5;return i.valueOf()-n;case"30m":var r=i.valueOf()%18e5;return i.valueOf()-r;case"1H":return i.startOf("hour").valueOf();case"2H":var s=i.valueOf()%72e5;return i.valueOf()-s;case"4H":var o=i.valueOf()%144e5;return i.valueOf()-o;case"6H":var c=i.valueOf()%216e5;return i.valueOf()-c;case"12H":var h=i.valueOf()%432e5;return i.valueOf()-h;case"1D":return i.startOf("day");case"1W":return i.startOf("week");case"1M":return i.startOf("month");case"1Y":return i.startOf("year").valueOf()}}}function P(t,e){for(var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5e3,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:800,n=[],r=e,s=i,o=[],c=0;c<a;c++){s=s+20*Math.random()-10;for(var h=0;h<4;h++)o[h]=12*(Math.random()-.5)+s;o.sort();var l=+Math.round(3*Math.random()).toFixed(0),u=+Math.round(2*Math.random()).toFixed(0);u===l&&u++;var d=200*Math.random()+10;r=b(t,r);var _={open:o[l],low:o[0],high:o[3],close:o[u],volume:d,timestamp:r};_.turnover=(_.open+_.close+_.high+_.low)/4*d,n.unshift(_)}return n}var E=function(t){Object(l.a)(i,t);var e=Object(u.a)(i);function i(t){var a;return Object(c.a)(this,i),(a=e.call(this,t)).changePeriod=function(t){return function(){var e=a.state.currentPeriod;e!==t&&("Line"===t?a.kLineChart.setCandleStickChartType("real_time"):"Line"===e&&a.kLineChart.setCandleStickChartType("candle_stick"),a.applyNewData(t),a.setState({currentPeriod:t}))}},a.changeCandleStickStyle=function(t){return function(){a.kLineChart.setStyleOptions({candleStick:{bar:{style:t.key}}}),a.setState({currentCandleStickIcon:t.icon})}},a.changeTechnicalIndicatorType=function(t){return function(){a.state.currentTechnicalIndicatorType!==t&&(a.kLineChart.setTechnicalIndicatorType(a.technicalIndicatorTag,t),a.setState({currentTechnicalIndicatorType:t}))}},a.changeCandleStickTechnicalIndicatorType=function(t){return function(){a.state.currentCandleStickTechnicalIndicatorType!==t&&(a.kLineChart.setCandleStickTechnicalIndicatorType(t),a.setState({currentCandleStickTechnicalIndicatorType:t}))}},a.showTechnicalIndicator=function(){var t=!a.state.isShowTechnicalIndicator;t?a.technicalIndicatorTag=a.kLineChart.addTechnicalIndicator(a.state.currentTechnicalIndicatorType,120):a.kLineChart.removeTechnicalIndicator(a.technicalIndicatorTag),a.setState({isShowTechnicalIndicator:t},(function(){a.kLineChart.resize()}))},a.screenShot=function(){var t=a.kLineChart.getConvertPictureUrl(!0,!0),e=document.createElement("a");e.download="screenShot",e.href=t,document.body.appendChild(e),e.click(),e.remove()},a.onSettingClose=function(){var t=a.state,e=t.timezone,i=t.technicalIndicatorParams;a.setState({tempTimezone:Object(o.a)({},e),tempTechnicalIndicatorParams:Object(o.a)({},i),isShowSettingModal:!1})},a.onSettingConfirm=function(){var t=a.state,e=t.tempTimezone,i=t.tempTechnicalIndicatorParams,n=Object(o.a)({},e),r=Object(o.a)({},i);for(var s in a.kLineChart.setTimezone(n.key),r)a.kLineChart.setTechnicalIndicatorParams(s,r[s]);a.setState({timezone:n,technicalIndicatorParams:r,isShowSettingModal:!1})},a.onResize=function(){a.kLineChart&&a.kLineChart.resize()},a.state={theme:"dark",language:"zh-CN",currentPeriod:"1m",currentCandleStickIcon:"icon-candle-stick-solid",currentCandleStickTechnicalIndicatorType:"MA",currentTechnicalIndicatorType:"MACD",isShowTechnicalIndicator:!1,isShowSettingModal:!1,timezone:{key:"Asia/Shanghai",text:"shanghai",utc:"(UTC+8)"},tempTimezone:{key:"Asia/Shanghai",text:"shanghai",utc:"(UTC+8)"},technicalIndicatorParams:{},tempTechnicalIndicatorParams:{}},a}return Object(h.a)(i,[{key:"getChartStyle",value:function(t,e){var i="dark"===t?"#D9D9D9":"#7F7F7F",a="dark"===t?"#393939":"#EEEEEE",n="dark"===t?"#888888":"#999999";return{grid:{horizontal:{display:!0,color:a},vertical:{display:!0,color:a}},candleStick:{priceMark:{high:{color:i},low:{color:i}}},technicalIndicator:{line:{colors:[i,"#F5A623","#F601FF","#1587DD","#1e88e5"]},lastValueMark:{display:!0}},xAxis:{axisLine:{color:n},tickLine:{color:n},tickText:{color:i}},yAxis:{axisLine:{color:n},tickLine:{color:n},tickText:{color:i}},separator:{color:n},floatLayer:{crossHair:{horizontal:{line:{color:n}},vertical:{line:{color:n}}},prompt:{candleStick:{labels:"zh-CN"===e?["\u65f6\u95f4","\u5f00","\u6536","\u9ad8","\u4f4e","\u6210\u4ea4\u91cf"]:["T","O","C","H","L","V"],text:{color:i}},technicalIndicator:{text:{color:i}}}}}}},{key:"componentDidMount",value:function(){var t=this,e=this.state,i=e.theme,a=e.language;this.kLineChart=Object(v.init)("k-line-chart"),window.addEventListener("resize",this.onResize),this.kLineChart.loadMore((function(e){t.applyMoreData(e)})),this.kLineChart.setStyleOptions(this.getChartStyle(i,a)),this.kLineChart.addTechnicalIndicator("VOL",120),this.applyNewData(this.state.currentPeriod),this.setState({tempTechnicalIndicatorParams:this.kLineChart.getTechnicalIndicatorParamOptions(),technicalIndicatorParams:this.kLineChart.getTechnicalIndicatorParamOptions()})}},{key:"componentDidUpdate",value:function(t,e,i){var a=this.state,n=a.theme,r=a.language;n===e.theme&&r===e.language||this.kLineChart.setStyleOptions(this.getChartStyle(n,r))}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.onResize),this.loadMoreDataTimer&&clearTimeout(this.loadMoreDataTimer),this.clearUpdateDataTimer(),Object(v.dispose)("k-line-chart")}},{key:"applyNewData",value:function(t){this.clearUpdateDataTimer(),this.kLineChart.applyNewData(P(t),!0),this.updateData(t)}},{key:"applyMoreData",value:function(t){var e=this;this.loadMoreDataTimer=setTimeout((function(){var i=e.kLineChart.getDataList()[0];e.kLineChart.applyMoreData(P(e.state.currentPeriod,t,i.close,200),!0)}),3e3)}},{key:"updateData",value:function(t){var e=this;this.updateDataTimer=setTimeout((function(){var i=e.kLineChart.getDataList(),a=i[i.length-1],n=a.timestamp,r=b(t),s=Object(o.a)({},a);if(_()(n).isBefore(r))s.high=s.close,s.low=s.close,s.open=s.close,s.volume=0,s.turnover=0,s.timestamp=r;else{var c=10*(Math.random()-.5)+s.close,h=+(3*Math.random()).toFixed(0);s.close=c,s.high=Math.max(s.high,c),s.low=Math.min(s.low,c),s.volume=s.volume+h,s.turnover=s.turnover+h*c}e.kLineChart.updateData(s),e.updateData(t)}),1e3*Math.random()+200)}},{key:"clearUpdateDataTimer",value:function(){this.updateDataTimer&&clearTimeout(this.updateDataTimer)}},{key:"render",value:function(){var t=this,e=this.state,i=e.theme,a=e.language,r=e.currentPeriod,s=e.currentCandleStickIcon,c=e.currentCandleStickTechnicalIndicatorType,h=e.currentTechnicalIndicatorType,l=e.isShowTechnicalIndicator,u=e.isShowSettingModal,d=e.tempTimezone,_=e.tempTechnicalIndicatorParams;return n.a.createElement("div",{className:"app-".concat(i)},u&&n.a.createElement(S,{theme:i,timezone:d,technicalIndicatorParams:_,onClose:this.onSettingClose,onConfirm:this.onSettingConfirm,onTimezoneChange:function(e){t.setState({tempTimezone:e})},onParamChange:function(e,i,a){var n=Object(o.a)({},_);n[e][i]=+(a||1),t.setState({tempTechnicalIndicatorParams:n})}}),n.a.createElement("i",{className:"github-triangle-tag"}),n.a.createElement("a",{className:"github-icon icon-github",target:"_blank",rel:"noopener noreferrer",href:"https://github.com/liihuu/KLineChart"}),n.a.createElement("div",{className:"period-container"},M.map((function(e){return n.a.createElement("span",{key:e,className:"".concat(r===e&&"period-selected"),onClick:t.changePeriod(e)},e)})),n.a.createElement("i",{className:"split-line",style:{marginLeft:8}}),n.a.createElement("div",{className:"select-container"},n.a.createElement("div",{className:"select"},n.a.createElement("span",null,c),n.a.createElement("i",{className:"select-arrow"})),n.a.createElement("ul",{className:"select-drop-down-container"},["MA","EMA","BOLL","SAR","NO"].map((function(e){return n.a.createElement("li",{key:e,className:"select-drop-down-row",onClick:t.changeCandleStickTechnicalIndicatorType(e)},n.a.createElement("span",{style:{paddingLeft:0}},e))})))),n.a.createElement("i",{className:"split-line"}),n.a.createElement("div",{className:"select-container"},n.a.createElement("div",{style:{width:30},className:"select"},n.a.createElement("i",{className:"period-icon ".concat(s)}),n.a.createElement("i",{className:"select-arrow"})),n.a.createElement("ul",{className:"select-drop-down-container"},T.map((function(e){return n.a.createElement("li",{key:e.key,className:"select-drop-down-row",onClick:t.changeCandleStickStyle(e)},n.a.createElement("i",{className:"period-icon ".concat(e.icon)}),n.a.createElement("span",null,y(e.text)))})))),n.a.createElement("i",{className:"split-line"}),n.a.createElement("i",{className:"period-icon icon-technical-indicator ".concat(l&&"period-icon-selected"),style:{marginLeft:12},onClick:this.showTechnicalIndicator}),n.a.createElement("i",{className:"period-icon icon-setting",style:{marginLeft:12,fontSize:16},onClick:function(){t.setState({isShowSettingModal:!0})}}),n.a.createElement("i",{className:"period-icon icon-screen-shot",style:{marginLeft:12},onClick:this.screenShot}),n.a.createElement("i",{className:"period-icon ".concat("dark"===i?"icon-sun":"icon-moon"),style:{marginLeft:12},onClick:function(){t.setState({theme:"dark"===i?"light":"dark"})}}),n.a.createElement("span",{style:{fontSize:14},onClick:function(){var e="zh-CN"===a?"en":"zh-CN";!function(t){p=t}(e),t.setState({language:e})}},"zh-CN"===a?"En":"\u4e2d")),n.a.createElement("div",{className:"app-content"},n.a.createElement("div",{className:"drawing-tools-container"},D.map((function(e){return n.a.createElement("div",{key:e.key,className:"drawing-tools-row",onClick:function(){t.kLineChart.addGraphicMark(e.key)}},n.a.createElement("i",{className:e.icon}))})),n.a.createElement("div",{className:"drawing-tools-row",onClick:function(){t.kLineChart.removeAllGraphicMark()}},n.a.createElement("i",{className:"icon-delete"}))),n.a.createElement("div",{className:"k-line-chart-container"},n.a.createElement("div",{id:"k-line-chart",style:l?{}:{height:"100%"}}),n.a.createElement("div",{className:"technical-indicator-container",style:{display:l?"flex":"none"}},C.map((function(e){return n.a.createElement("span",{key:e,className:"".concat(h===e&&"technical-indicator-selected"),onClick:t.changeTechnicalIndicatorType(e)},e)}))))))}}]),i}(a.PureComponent),A=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function L(t,e){navigator.serviceWorker.register(t).then((function(t){t.onupdatefound=function(){var i=t.installing;null!=i&&(i.onstatechange=function(){"installed"===i.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),e&&e.onUpdate&&e.onUpdate(t)):(console.log("Content is cached for offline use."),e&&e.onSuccess&&e.onSuccess(t)))})}})).catch((function(t){console.error("Error during service worker registration:",t)}))}i(23);s.a.render(n.a.createElement(n.a.StrictMode,null,n.a.createElement(E,null)),document.getElementById("root")),function(t){if("serviceWorker"in navigator){if(new URL("/KLineChart",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var e="".concat("/KLineChart","/service-worker.js");A?(!function(t,e){fetch(t,{headers:{"Service-Worker":"script"}}).then((function(i){var a=i.headers.get("content-type");404===i.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then((function(t){t.unregister().then((function(){window.location.reload()}))})):L(t,e)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(e,t),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):L(e,t)}))}}()}],[[12,1,2]]]);
//# sourceMappingURL=main.ef445ea1.chunk.js.map